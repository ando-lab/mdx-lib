classdef AbsorptionCoefficient
    %AbsorptionCoefficient 
    %
    % data from NIST:
    % https://www.nist.gov/pml/x-ray-mass-attenuation-coefficients
    %
    % units are cm^2/g
    % wavelength in angstrom (used by access methods)
    % energy in MeV
    properties(SetAccess = private)
        atomName
        dataTable
    end
    properties(Constant = true, Access = private)
        % hard-coded: see private/parse_nist_data.m
nist_data_c = table({'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';''},[1.00000E-03;1.50000E-03;2.00000E-03;3.00000E-03;4.00000E-03;5.00000E-03;6.00000E-03;8.00000E-03;1.00000E-02;1.50000E-02;2.00000E-02;3.00000E-02;4.00000E-02;5.00000E-02;6.00000E-02;8.00000E-02;1.00000E-01;1.50000E-01;2.00000E-01;3.00000E-01;4.00000E-01;5.00000E-01;6.00000E-01;8.00000E-01;1.00000E+00;1.25000E+00;1.50000E+00;2.00000E+00;3.00000E+00;4.00000E+00;5.00000E+00;6.00000E+00;8.00000E+00;1.00000E+01;1.50000E+01;2.00000E+01],[2.211E+03;7.002E+02;3.026E+02;9.033E+01;3.778E+01;1.912E+01;1.095E+01;4.576E+00;2.373E+00;8.071E-01;4.420E-01;2.562E-01;2.076E-01;1.871E-01;1.753E-01;1.610E-01;1.514E-01;1.347E-01;1.229E-01;1.066E-01;9.546E-02;8.715E-02;8.058E-02;7.076E-02;6.361E-02;5.690E-02;5.179E-02;4.442E-02;3.562E-02;3.047E-02;2.708E-02;2.469E-02;2.154E-02;1.959E-02;1.698E-02;1.575E-02],[2.209E+03;6.990E+02;3.016E+02;8.963E+01;3.723E+01;1.866E+01;1.054E+01;4.242E+00;2.078E+00;5.627E-01;2.238E-01;6.614E-02;3.343E-02;2.397E-02;2.098E-02;2.037E-02;2.147E-02;2.449E-02;2.655E-02;2.870E-02;2.950E-02;2.969E-02;2.956E-02;2.885E-02;2.792E-02;2.669E-02;2.551E-02;2.345E-02;2.048E-02;1.849E-02;1.710E-02;1.607E-02;1.468E-02;1.380E-02;1.258E-02;1.198E-02],'VariableNames',{'edge','energy','mu_atten','mu_en'});
nist_data_cd = table({'';'';'';'';'';'L3';'';'';'L2';'';'';'L1';'';'';'';'';'';'';'';'K';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';''},[1.00000E-03;1.50000E-03;2.00000E-03;3.00000E-03;3.53750E-03;3.53750E-03;3.63101E-03;3.72700E-03;3.72700E-03;4.00000E-03;4.01800E-03;4.01800E-03;5.00000E-03;6.00000E-03;8.00000E-03;1.00000E-02;1.50000E-02;2.00000E-02;2.67112E-02;2.67112E-02;3.00000E-02;4.00000E-02;5.00000E-02;6.00000E-02;8.00000E-02;1.00000E-01;1.50000E-01;2.00000E-01;3.00000E-01;4.00000E-01;5.00000E-01;6.00000E-01;8.00000E-01;1.00000E+00;1.25000E+00;1.50000E+00;2.00000E+00;3.00000E+00;4.00000E+00;5.00000E+00;6.00000E+00;8.00000E+00;1.00000E+01;1.50000E+01;2.00000E+01],[7.350E+03;2.931E+03;1.473E+03;5.414E+02;3.575E+02;1.152E+03;1.083E+03;1.013E+03;1.389E+03;1.170E+03;1.157E+03;1.324E+03;7.685E+02;4.793E+02;2.254E+02;1.244E+02;4.178E+01;1.920E+01;8.809E+00;5.065E+01;3.765E+01;1.778E+01;9.779E+00;5.975E+00;2.751E+00;1.524E+00;5.593E-01;3.038E-01;1.571E-01;1.129E-01;9.250E-02;8.064E-02;6.670E-02;5.826E-02;5.129E-02;4.673E-02;4.139E-02;3.698E-02;3.559E-02;3.536E-02;3.563E-02;3.691E-02;3.853E-02;4.253E-02;4.587E-02],[7.340E+03;2.922E+03;1.466E+03;5.350E+02;3.517E+02;1.103E+03;1.036E+03;9.715E+02;1.324E+03;1.118E+03;1.106E+03;1.264E+03;7.383E+02;4.619E+02;2.174E+02;1.197E+02;3.952E+01;1.776E+01;7.863E+00;1.821E+01;1.594E+01;9.812E+00;6.115E+00;4.001E+00;1.957E+00;1.096E+00;3.753E-01;1.813E-01;7.580E-02;4.868E-02;3.838E-02;3.339E-02;2.854E-02;2.597E-02;2.387E-02;2.247E-02;2.099E-02;2.051E-02;2.114E-02;2.206E-02;2.300E-02;2.477E-02;2.625E-02;2.869E-02;2.985E-02],'VariableNames',{'edge','energy','mu_atten','mu_en'});
nist_data_cl = table({'';'';'';'';'K';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';''},[1.00000E-03;1.50000E-03;2.00000E-03;2.82240E-03;2.82240E-03;3.00000E-03;4.00000E-03;5.00000E-03;6.00000E-03;8.00000E-03;1.00000E-02;1.50000E-02;2.00000E-02;3.00000E-02;4.00000E-02;5.00000E-02;6.00000E-02;8.00000E-02;1.00000E-01;1.50000E-01;2.00000E-01;3.00000E-01;4.00000E-01;5.00000E-01;6.00000E-01;8.00000E-01;1.00000E+00;1.25000E+00;1.50000E+00;2.00000E+00;3.00000E+00;4.00000E+00;5.00000E+00;6.00000E+00;8.00000E+00;1.00000E+01;1.50000E+01;2.00000E+01],[2.832E+03;9.771E+02;4.520E+02;1.774E+02;1.637E+03;1.473E+03;7.037E+02;3.901E+02;2.384E+02;1.075E+02;5.725E+01;1.784E+01;7.739E+00;2.425E+00;1.117E+00;6.483E-01;4.395E-01;2.696E-01;2.050E-01;1.480E-01;1.266E-01;1.054E-01;9.311E-02;8.453E-02;7.795E-02;6.826E-02;6.128E-02;5.478E-02;4.994E-02;4.328E-02;3.585E-02;3.188E-02;2.950E-02;2.798E-02;2.628E-02;2.549E-02;2.496E-02;2.520E-02],[2.829E+03;9.742E+02;4.494E+02;1.752E+02;1.506E+03;1.361E+03;6.626E+02;3.711E+02;2.282E+02;1.034E+02;5.510E+01;1.700E+01;7.227E+00;2.114E+00;8.756E-01;4.433E-01;2.570E-01;1.148E-01;6.745E-02;3.639E-02;3.067E-02;2.898E-02;2.887E-02;2.874E-02;2.847E-02;2.767E-02;2.671E-02;2.549E-02;2.436E-02;2.258E-02;2.043E-02;1.931E-02;1.871E-02;1.839E-02;1.819E-02;1.824E-02;1.861E-02;1.899E-02],'VariableNames',{'edge','energy','mu_atten','mu_en'});
nist_data_h = table({'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';''},[1.00000E-03;1.50000E-03;2.00000E-03;3.00000E-03;4.00000E-03;5.00000E-03;6.00000E-03;8.00000E-03;1.00000E-02;1.50000E-02;2.00000E-02;3.00000E-02;4.00000E-02;5.00000E-02;6.00000E-02;8.00000E-02;1.00000E-01;1.50000E-01;2.00000E-01;3.00000E-01;4.00000E-01;5.00000E-01;6.00000E-01;8.00000E-01;1.00000E+00;1.25000E+00;1.50000E+00;2.00000E+00;3.00000E+00;4.00000E+00;5.00000E+00;6.00000E+00;8.00000E+00;1.00000E+01;1.50000E+01;2.00000E+01],[7.217E+00;2.148E+00;1.059E+00;5.612E-01;4.546E-01;4.193E-01;4.042E-01;3.914E-01;3.854E-01;3.764E-01;3.695E-01;3.570E-01;3.458E-01;3.355E-01;3.260E-01;3.091E-01;2.944E-01;2.651E-01;2.429E-01;2.112E-01;1.893E-01;1.729E-01;1.599E-01;1.405E-01;1.263E-01;1.129E-01;1.027E-01;8.769E-02;6.921E-02;5.806E-02;5.049E-02;4.498E-02;3.746E-02;3.254E-02;2.539E-02;2.153E-02],[6.820E+00;1.752E+00;6.643E-01;1.693E-01;6.549E-02;3.278E-02;1.996E-02;1.160E-02;9.849E-03;1.102E-02;1.355E-02;1.863E-02;2.315E-02;2.709E-02;3.053E-02;3.620E-02;4.063E-02;4.813E-02;5.254E-02;5.695E-02;5.860E-02;5.900E-02;5.875E-02;5.739E-02;5.556E-02;5.311E-02;5.075E-02;4.650E-02;3.992E-02;3.523E-02;3.174E-02;2.905E-02;2.515E-02;2.247E-02;1.837E-02;1.606E-02],'VariableNames',{'edge','energy','mu_atten','mu_en'});
nist_data_n = table({'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';''},[1.00000E-03;1.50000E-03;2.00000E-03;3.00000E-03;4.00000E-03;5.00000E-03;6.00000E-03;8.00000E-03;1.00000E-02;1.50000E-02;2.00000E-02;3.00000E-02;4.00000E-02;5.00000E-02;6.00000E-02;8.00000E-02;1.00000E-01;1.50000E-01;2.00000E-01;3.00000E-01;4.00000E-01;5.00000E-01;6.00000E-01;8.00000E-01;1.00000E+00;1.25000E+00;1.50000E+00;2.00000E+00;3.00000E+00;4.00000E+00;5.00000E+00;6.00000E+00;8.00000E+00;1.00000E+01;1.50000E+01;2.00000E+01],[3.311E+03;1.083E+03;4.769E+02;1.456E+02;6.166E+01;3.144E+01;1.809E+01;7.562E+00;3.879E+00;1.236E+00;6.178E-01;3.066E-01;2.288E-01;1.980E-01;1.817E-01;1.639E-01;1.529E-01;1.353E-01;1.233E-01;1.068E-01;9.557E-02;8.719E-02;8.063E-02;7.081E-02;6.364E-02;5.693E-02;5.180E-02;4.450E-02;3.579E-02;3.073E-02;2.742E-02;2.511E-02;2.209E-02;2.024E-02;1.782E-02;1.673E-02],[3.306E+03;1.080E+03;4.755E+02;1.447E+02;6.094E+01;3.086E+01;1.759E+01;7.170E+00;3.545E+00;9.715E-01;3.867E-01;1.099E-01;5.051E-02;3.217E-02;2.548E-02;2.211E-02;2.231E-02;2.472E-02;2.665E-02;2.873E-02;2.952E-02;2.969E-02;2.956E-02;2.886E-02;2.792E-02;2.669E-02;2.550E-02;2.347E-02;2.057E-02;1.867E-02;1.734E-02;1.639E-02;1.512E-02;1.434E-02;1.332E-02;1.285E-02],'VariableNames',{'edge','energy','mu_atten','mu_en'});
nist_data_na = table({'';'';'';'K';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';''},[1.00000E-03;1.03542E-03;1.07210E-03;1.07210E-03;1.50000E-03;2.00000E-03;3.00000E-03;4.00000E-03;5.00000E-03;6.00000E-03;8.00000E-03;1.00000E-02;1.50000E-02;2.00000E-02;3.00000E-02;4.00000E-02;5.00000E-02;6.00000E-02;8.00000E-02;1.00000E-01;1.50000E-01;2.00000E-01;3.00000E-01;4.00000E-01;5.00000E-01;6.00000E-01;8.00000E-01;1.00000E+00;1.25000E+00;1.50000E+00;2.00000E+00;3.00000E+00;4.00000E+00;5.00000E+00;6.00000E+00;8.00000E+00;1.00000E+01;1.50000E+01;2.00000E+01],[6.542E+02;5.960E+02;5.429E+02;6.435E+03;3.194E+03;1.521E+03;5.070E+02;2.261E+02;1.194E+02;7.030E+01;3.018E+01;1.557E+01;4.694E+00;2.057E+00;7.197E-01;3.969E-01;2.804E-01;2.268E-01;1.796E-01;1.585E-01;1.335E-01;1.199E-01;1.029E-01;9.185E-02;8.372E-02;7.736E-02;6.788E-02;6.100E-02;5.454E-02;4.968E-02;4.282E-02;3.487E-02;3.037E-02;2.753E-02;2.559E-02;2.319E-02;2.181E-02;2.023E-02;1.970E-02],[6.522E+02;5.941E+02;5.410E+02;6.320E+03;3.151E+03;1.504E+03;5.023E+02;2.238E+02;1.178E+02;6.915E+01;2.941E+01;1.499E+01;4.313E+00;1.759E+00;4.928E-01;2.031E-01;1.063E-01;6.625E-02;3.761E-02;2.931E-02;2.579E-02;2.635E-02;2.771E-02;2.833E-02;2.845E-02;2.830E-02;2.760E-02;2.669E-02;2.549E-02;2.437E-02;2.249E-02;1.997E-02;1.842E-02;1.743E-02;1.675E-02;1.595E-02;1.552E-02;1.508E-02;1.496E-02],'VariableNames',{'edge','energy','mu_atten','mu_en'});
nist_data_o = table({'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';''},[1.00000E-03;1.50000E-03;2.00000E-03;3.00000E-03;4.00000E-03;5.00000E-03;6.00000E-03;8.00000E-03;1.00000E-02;1.50000E-02;2.00000E-02;3.00000E-02;4.00000E-02;5.00000E-02;6.00000E-02;8.00000E-02;1.00000E-01;1.50000E-01;2.00000E-01;3.00000E-01;4.00000E-01;5.00000E-01;6.00000E-01;8.00000E-01;1.00000E+00;1.25000E+00;1.50000E+00;2.00000E+00;3.00000E+00;4.00000E+00;5.00000E+00;6.00000E+00;8.00000E+00;1.00000E+01;1.50000E+01;2.00000E+01],[4.590E+03;1.549E+03;6.949E+02;2.171E+02;9.315E+01;4.790E+01;2.770E+01;1.163E+01;5.952E+00;1.836E+00;8.651E-01;3.779E-01;2.585E-01;2.132E-01;1.907E-01;1.678E-01;1.551E-01;1.361E-01;1.237E-01;1.070E-01;9.566E-02;8.729E-02;8.070E-02;7.087E-02;6.372E-02;5.697E-02;5.185E-02;4.459E-02;3.597E-02;3.100E-02;2.777E-02;2.552E-02;2.263E-02;2.089E-02;1.866E-02;1.770E-02],[4.576E+03;1.545E+03;6.926E+02;2.158E+02;9.221E+01;4.715E+01;2.708E+01;1.116E+01;5.565E+00;1.545E+00;6.179E-01;1.729E-01;7.530E-02;4.414E-02;3.207E-02;2.468E-02;2.355E-02;2.506E-02;2.679E-02;2.877E-02;2.953E-02;2.971E-02;2.957E-02;2.887E-02;2.794E-02;2.669E-02;2.551E-02;2.350E-02;2.066E-02;1.882E-02;1.757E-02;1.668E-02;1.553E-02;1.483E-02;1.396E-02;1.360E-02],'VariableNames',{'edge','energy','mu_atten','mu_en'});
nist_data_p = table({'';'';'';'';'K';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';''},[1.00000E-03;1.50000E-03;2.00000E-03;2.14550E-03;2.14550E-03;3.00000E-03;4.00000E-03;5.00000E-03;6.00000E-03;8.00000E-03;1.00000E-02;1.50000E-02;2.00000E-02;3.00000E-02;4.00000E-02;5.00000E-02;6.00000E-02;8.00000E-02;1.00000E-01;1.50000E-01;2.00000E-01;3.00000E-01;4.00000E-01;5.00000E-01;6.00000E-01;8.00000E-01;1.00000E+00;1.25000E+00;1.50000E+00;2.00000E+00;3.00000E+00;4.00000E+00;5.00000E+00;6.00000E+00;8.00000E+00;1.00000E+01;1.50000E+01;2.00000E+01],[1.913E+03;6.547E+02;3.018E+02;2.494E+02;2.473E+03;1.118E+03;5.242E+02;2.860E+02;1.726E+02;7.660E+01;4.035E+01;1.239E+01;5.352E+00;1.700E+00;8.096E-01;4.916E-01;3.494E-01;2.324E-01;1.865E-01;1.432E-01;1.250E-01;1.055E-01;9.359E-02;8.511E-02;7.854E-02;6.884E-02;6.182E-02;5.526E-02;5.039E-02;4.358E-02;3.590E-02;3.172E-02;2.915E-02;2.747E-02;2.552E-02;2.452E-02;2.364E-02;2.363E-02],[1.910E+03;6.522E+02;2.996E+02;2.473E+02;2.343E+03;1.074E+03;5.079E+02;2.782E+02;1.682E+02;7.457E+01;3.912E+01;1.179E+01;4.939E+00;1.422E+00;5.850E-01;2.965E-01;1.735E-01;8.083E-02;5.068E-02;3.188E-02;2.899E-02;2.870E-02;2.892E-02;2.891E-02;2.869E-02;2.793E-02;2.698E-02;2.575E-02;2.462E-02;2.279E-02;2.049E-02;1.921E-02;1.846E-02;1.801E-02;1.760E-02;1.747E-02;1.754E-02;1.771E-02],'VariableNames',{'edge','energy','mu_atten','mu_en'});
nist_data_s = table({'';'';'';'';'K';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';''},[1.00000E-03;1.50000E-03;2.00000E-03;2.47200E-03;2.47200E-03;3.00000E-03;4.00000E-03;5.00000E-03;6.00000E-03;8.00000E-03;1.00000E-02;1.50000E-02;2.00000E-02;3.00000E-02;4.00000E-02;5.00000E-02;6.00000E-02;8.00000E-02;1.00000E-01;1.50000E-01;2.00000E-01;3.00000E-01;4.00000E-01;5.00000E-01;6.00000E-01;8.00000E-01;1.00000E+00;1.25000E+00;1.50000E+00;2.00000E+00;3.00000E+00;4.00000E+00;5.00000E+00;6.00000E+00;8.00000E+00;1.00000E+01;1.50000E+01;2.00000E+01],[2.429E+03;8.342E+02;3.853E+02;2.168E+02;2.070E+03;1.339E+03;6.338E+02;3.487E+02;2.116E+02;9.465E+01;5.012E+01;1.550E+01;6.708E+00;2.113E+00;9.872E-01;5.849E-01;4.053E-01;2.585E-01;2.020E-01;1.506E-01;1.302E-01;1.091E-01;9.665E-02;8.781E-02;8.102E-02;7.098E-02;6.373E-02;5.697E-02;5.193E-02;4.498E-02;3.715E-02;3.293E-02;3.036E-02;2.872E-02;2.682E-02;2.589E-02;2.517E-02;2.529E-02],[2.426E+03;8.314E+02;3.828E+02;2.145E+02;1.935E+03;1.265E+03;6.066E+02;3.360E+02;2.046E+02;9.171E+01;4.847E+01;1.477E+01;6.235E+00;1.809E+00;7.466E-01;3.779E-01;2.199E-01;1.000E-01;6.052E-02;3.516E-02;3.080E-02;2.983E-02;2.991E-02;2.984E-02;2.959E-02;2.878E-02;2.780E-02;2.652E-02;2.535E-02;2.349E-02;2.118E-02;1.993E-02;1.923E-02;1.884E-02;1.850E-02;1.845E-02;1.864E-02;1.889E-02],'VariableNames',{'edge','energy','mu_atten','mu_en'});
nist_data_se = table({'';'';'';'L3';'';'';'L2';'';'';'L1';'';'';'';'';'';'';'';'';'K';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';'';''},[1.00000E-03;1.19825E-03;1.43580E-03;1.43580E-03;1.45586E-03;1.47620E-03;1.47620E-03;1.50000E-03;1.65390E-03;1.65390E-03;2.00000E-03;3.00000E-03;4.00000E-03;5.00000E-03;6.00000E-03;8.00000E-03;1.00000E-02;1.26578E-02;1.26578E-02;1.50000E-02;2.00000E-02;3.00000E-02;4.00000E-02;5.00000E-02;6.00000E-02;8.00000E-02;1.00000E-01;1.50000E-01;2.00000E-01;3.00000E-01;4.00000E-01;5.00000E-01;6.00000E-01;8.00000E-01;1.00000E+00;1.25000E+00;1.50000E+00;2.00000E+00;3.00000E+00;4.00000E+00;5.00000E+00;6.00000E+00;8.00000E+00;1.00000E+01;1.50000E+01;2.00000E+01],[2.317E+03;1.512E+03;9.814E+02;4.347E+03;4.057E+03;3.907E+03;5.186E+03;5.336E+03;4.342E+03;4.915E+03;3.098E+03;1.116E+03;5.252E+02;2.896E+02;1.773E+02;8.116E+01;4.414E+01;2.318E+01;1.589E+02;1.033E+02;4.818E+01;1.596E+01;7.184E+00;3.864E+00;2.341E+00;1.090E+00;6.278E-01;2.703E-01;1.742E-01;1.144E-01;9.299E-02;8.129E-02;7.350E-02;6.314E-02;5.619E-02;4.999E-02;4.564E-02;4.010E-02;3.476E-02;3.247E-02;3.145E-02;3.105E-02;3.119E-02;3.186E-02;3.395E-02;3.599E-02],[2.312E+03;1.506E+03;9.760E+02;4.287E+03;4.002E+03;3.855E+03;5.112E+03;5.260E+03;4.284E+03;4.849E+03;3.062E+03;1.104E+03;5.187E+02;2.851E+02;1.737E+02;7.865E+01;4.221E+01;2.173E+01;8.599E+01;6.270E+01;3.352E+01;1.240E+01;5.796E+00;3.143E+00;1.886E+00;8.332E-01;4.426E-01;1.483E-01;7.695E-02;4.113E-02;3.261E-02;2.941E-02;2.775E-02;2.581E-02;2.446E-02;2.306E-02;2.195E-02;2.052E-02;1.947E-02;1.944E-02;1.978E-02;2.025E-02;2.130E-02;2.226E-02;2.394E-02;2.487E-02],'VariableNames',{'edge','energy','mu_atten','mu_en'});
    end
    methods
        function obj = AbsorptionCoefficient(atomName)
            
            switch lower(atomName)
                case 'h'
                    obj.atomName = 'H';
                    obj.dataTable = obj.nist_data_h;
                case 'c'
                    obj.atomName = 'C';
                    obj.dataTable = obj.nist_data_c;
                case 'n'
                    obj.atomName = 'N';
                    obj.dataTable = obj.nist_data_n;
                case 'o'
                    obj.atomName = 'O';
                    obj.dataTable = obj.nist_data_o;
                case 'p'
                    obj.atomName = 'P';
                    obj.dataTable = obj.nist_data_p;
                case 's'
                    obj.atomName = 'S';
                    obj.dataTable = obj.nist_data_s;
                case 'na'
                    obj.atomName = 'Na';
                    obj.dataTable = obj.nist_data_na;
                case 'cl'
                    obj.atomName = 'Cl';
                    obj.dataTable = obj.nist_data_cl;
                case 'cd'
                    obj.atomName = 'Cd';
                    obj.dataTable = obj.nist_data_cd;
                case 'se'
                    obj.atomName = 'Se';
                    obj.dataTable = obj.nist_data_se;
                otherwise
                    obj.atomName = atomName;
                    warning('absorption coefficent not implemented!');
            end
        end
        
        function v = massAttenuationCoefficient(obj,wavelength)
            v = obj.interpolateCoefficient(wavelength,'mu_atten');
        end
        
        function v = massEnergyAbsorptionCoefficient(obj,wavelength)
            v = obj.interpolateCoefficient(wavelength,'mu_en');
        end
    end
    methods(Access = private)
        function v = interpolateCoefficient(obj,wavelength,coeffname)
            isEdge = cellfun(@(c) ~isempty(c),obj.dataTable.edge);
            eV_A = 12398.42; % convert from eV to Angstrom
            ener = eV_A./wavelength; % energy in eV
            ener = ener*1E-6; % energy in MeV
            
            x = log(obj.dataTable.energy);
            
            switch coeffname
                case 'mu_atten'
                    y = log(obj.dataTable.mu_atten);
                case 'mu_en'
                    y = log(obj.dataTable.mu_en);
                otherwise
                    error('this shouldnt happen... ever');
            end
            
            x(isEdge) = x(isEdge) + 10*eps;
            logv = interp1(x,y,log(ener));
            v = exp(logv);
        end
    end
end


