
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Process</title><meta name="generator" content="MATLAB 9.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2020-01-17"><meta name="DC.source" content="process.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Process</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">Create input geometry objects</a></li><li><a href="#3">Integrate on a coarse grid (for scaling)</a></li><li><a href="#10">Plot of overall scale factor vs. frame number (b)</a></li><li><a href="#12">Plot of coarse map intensity vs. resolution (1/d)</a></li><li><a href="#13">Plot of coarse map intensity slice (l = 0)</a></li><li><a href="#14">Integrate on a fine grid</a></li><li><a href="#18">Plot of fine grid intensity vs. resolution (1/d)</a></li><li><a href="#19">Plot of fine grid intensity slice (l = 0)</a></li><li><a href="#20">Plot of CC* vs. resolution (1/d)</a></li></ul></div><p>check that mdx is on path</p><pre class="codeinput"><span class="keyword">try</span>
    geom.Detector();
<span class="keyword">catch</span>
    error(<span class="string">'mdx is not on the path! edit setup_environment.m and run'</span>);
<span class="keyword">end</span>
</pre><h2 id="2">Create input geometry objects</h2><p>hote: The normal workflow is to run XDS and import the geometry using proc.Batch.xds2geom() and proc.Batch.cbf2geom(). However, for this demo the simulated diffraction images are small and lack Bragg peaks, so XDS cannot be run beforehand. Running the input_geometry script creates the objects directly.</p><pre class="codeinput"><span class="keyword">if</span> ~isfolder(<span class="string">'proc'</span>), mkdir(<span class="string">'proc'</span>); <span class="keyword">end</span>

input_geometry(); <span class="comment">% creates proc/geom.mat and proc/geomBkg.mat</span>
</pre><h2 id="3">Integrate on a coarse grid (for scaling)</h2><p><b>proc.Batch.filter</b></p><pre class="codeinput">[tf, errorMessage] = proc.Batch.filter(<span class="keyword">...</span>
    <span class="string">'workingDirectory'</span>,<span class="string">'proc'</span>,<span class="keyword">...</span>
    <span class="string">'ndiv'</span>,[3,5,5],<span class="keyword">...</span><span class="comment"> % coarse grid divisions</span>
    <span class="string">'maxCount'</span>,50,<span class="keyword">...</span><span class="comment">  % histogram up to maxCount</span>
    <span class="string">'parallel'</span>,false<span class="keyword">...</span><span class="comment"> % true requires parallel processing toolbox</span>
    );

<span class="keyword">if</span> ~tf, rethrow(errorMessage);<span class="keyword">end</span>
</pre><pre class="codeoutput">
proc.Batch.filter
date: 17-Jan-2020 15:47:40
workingDirectory: proc
geometryIn: geom.mat
matOut: filter.mat
logOut: filter.log
ndiv: [3 5 5]
window: 2
maxCount: 50
smax: Inf
refineGrid: 1
parallel: 0

  checking input file geom.mat
  reading workspace variables from file proc/geom.mat
    InputGeometry
    RefinedGeometry
    InputImageSeries
    WedgeImageSeries
  reading first image (to update bad pixel mask)
  processing wedge 1 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 2 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 3 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 4 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 5 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 6 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 7 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 8 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 9 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 10 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 11 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 12 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 13 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 14 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 15 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 16 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 17 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 18 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 19 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 20 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 21 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 22 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 23 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 24 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 25 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 26 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 27 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 28 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 29 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 30 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 31 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 32 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 33 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 34 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 35 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  processing wedge 36 of 36
    initializing the Integrater
    initializing the reference grid
    reading images and accumulating count histogram
    initializing the Filter
    designing moving window
    calculating moving weighted median
    calculating KL divergence of count histograms and Poisson distribution
    identifying outliers
    generating integration mask
  Refining the integration masks
  checking output file filter.mat

WARNING: Output file already exists and will be overwritten.

  saving workspace variables to file: proc/filter.mat
    options
    Grid
    pixelMask

proc.Batch.filter
date: 17-Jan-2020 15:48:09
Done!
</pre><p><b>proc.Batch.integrate</b></p><pre class="codeinput">[tf,errorMessage] = proc.Batch.integrate(<span class="keyword">...</span>
    <span class="string">'workingDirectory'</span>,<span class="string">'proc'</span>,<span class="keyword">...</span>
    <span class="string">'parallel'</span>,false<span class="keyword">...</span><span class="comment"> % requires parallel processing toolbox</span>
    );

<span class="keyword">if</span> ~tf, rethrow(errorMessage);<span class="keyword">end</span>
</pre><pre class="codeoutput">
proc.Batch.integrate
date: 17-Jan-2020 15:48:09
workingDirectory: proc
geometryIn: geom.mat
gridIn: filter.mat
matOut: integrate.mat
logOut: integrate.log
binMode: coarse
binExcludedVoxels: 1
parallel: 0

  checking input file geom.mat
  reading workspace variables from file proc/geom.mat
    InputGeometry
    RefinedGeometry
    InputImageSeries
    WedgeImageSeries
  checking input file filter.mat
  reading workspace variables from file proc/filter.mat
    Grid
    pixelMask
  processing wedge 1 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 2 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 3 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 4 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 5 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 6 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 7 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 8 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 9 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 10 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 11 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 12 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 13 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 14 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 15 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 16 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 17 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 18 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 19 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 20 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 21 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 22 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 23 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 24 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 25 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 26 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 27 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 28 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 29 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 30 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 31 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 32 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 33 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 34 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 35 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 36 of 36
    initializing the Integrater
    reading images and accumulating counts
  checking output file integrate.mat

WARNING: Output file already exists and will be overwritten.

  saving workspace variables to file: proc/integrate.mat
    options
    bin
    binExcl

proc.Batch.integrate
date: 17-Jan-2020 15:48:11
Done!
</pre><p><b>proc.Batch.correct</b></p><pre class="codeinput">[tf,errorMessage] = proc.Batch.correct(<span class="keyword">...</span>
    <span class="string">'workingDirectory'</span>,<span class="string">'proc'</span>,<span class="keyword">...</span>
    <span class="string">'parallel'</span>,false<span class="keyword">...</span><span class="comment"> % requires parallel processing toolbox</span>
    );

<span class="keyword">if</span> ~tf, rethrow(errorMessage);<span class="keyword">end</span>
</pre><pre class="codeoutput">
proc.Batch.correct
date: 17-Jan-2020 15:48:11
workingDirectory: proc
geometryIn: geom.mat
gridIn: filter.mat
bkgGeometryIn: geomBkg.mat
matOut: correct.mat
logOut: correct.log
binMode: coarse
readBackground: 1
readImageHeaders: 1
exposureTimeField: Exposure_time
parallel: 0
binExcludedVoxels: 1

  checking input file geom.mat
  reading workspace variables from file proc/geom.mat
    InputGeometry
    RefinedGeometry
    InputImageSeries
    WedgeImageSeries
  checking input file filter.mat
  reading workspace variables from file proc/filter.mat
    Grid
    pixelMask
  checking input file geomBkg.mat
  reading workspace variables from file proc/geomBkg.mat
    InputImageSeries
    WedgeImageSeries
  processing wedge 1 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 2 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 3 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 4 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 5 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 6 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 7 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 8 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 9 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 10 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 11 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 12 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 13 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 14 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 15 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 16 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 17 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 18 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 19 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 20 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 21 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 22 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 23 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 24 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 25 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 26 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 27 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 28 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 29 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 30 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 31 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 32 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 33 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 34 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 35 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 36 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  checking output file correct.mat

WARNING: Output file already exists and will be overwritten.

  saving workspace variables to file: proc/correct.mat
    options
    corr
    corrExcl

proc.Batch.correct
date: 17-Jan-2020 15:48:14
Done!
</pre><p><b>proc.Batch.export</b></p><pre class="codeinput">[tf,errorMessage] = proc.Batch.export(<span class="keyword">...</span>
    <span class="string">'workingDirectory'</span>,<span class="string">'proc'</span>);

<span class="keyword">if</span> ~tf, rethrow(errorMessage);<span class="keyword">end</span>
</pre><pre class="codeoutput">
proc.Batch.export
date: 17-Jan-2020 15:48:14
workingDirectory: proc
geometryIn: geom.mat
gridIn: filter.mat
integrateIn: integrate.mat
correctIn: correct.mat
matOut: export.mat
logOut: export.log
minimumCounts: 0
minimumPixels: 1
binExcludedVoxels: 1

  checking input file geom.mat
  reading workspace variables from file proc/geom.mat
    InputGeometry
    RefinedGeometry
  checking input file filter.mat
  reading workspace variables from file proc/filter.mat
    Grid
  checking input file integrate.mat
  reading workspace variables from file proc/integrate.mat
    bin
    binExcl
  checking input file correct.mat
  reading workspace variables from file proc/correct.mat
    corr
    corrExcl
  averaging geometry object
  checking output file export.mat

WARNING: Output file already exists and will be overwritten.

  saving workspace variables to file: proc/export.mat
    options
    AverageGeometry
    diffuseTable
    braggTable

proc.Batch.export
date: 17-Jan-2020 15:48:15
Done!
</pre><p><b>proc.Batch.combine</b></p><pre class="codeinput">[tf,errorMessage] = proc.Batch.combine(<span class="keyword">...</span>
    <span class="string">'workingDirectory'</span>,<span class="string">'proc'</span>,<span class="keyword">...</span>
    <span class="string">'exportIn'</span>,{<span class="string">'export.mat'</span>},<span class="keyword">...</span>
    <span class="string">'mergeNeighbors'</span>,true,<span class="keyword">...</span>
    <span class="string">'combineBragg'</span>,false,<span class="keyword">...</span>
    <span class="string">'nwx'</span>,4,<span class="keyword">...</span><span class="comment"> % some default parameters for ScalingModel</span>
    <span class="string">'nwy'</span>,4);

<span class="keyword">if</span> ~tf, rethrow(errorMessage);<span class="keyword">end</span>
</pre><pre class="codeoutput">
proc.Batch.combine
date: 17-Jan-2020 15:48:15
workingDirectory: proc
exportIn: export.mat
matOut: combine.mat
logOut: combine.log
mergeNeighbors: 1
combineBragg: 0
neighborMaxSep: 0.5
fractionRangeBragg: [0.95 1.05]
nws: 100
nwx: 4
nwy: 4

  checking input file export.mat
  reading workspace variables from file proc/export.mat
    diffuseTable
    AverageGeometry
  pre-processing batch 1
    merging equivalent observations within 5 frames of each other
      24 observations merged in diffuse table, 16560 remaining
  loading diffuse data from batch 1 into table
  checking output file combine.mat

WARNING: Output file already exists and will be overwritten.

  saving workspace variables to file: proc/combine.mat
    options
    diffuseTable
    ScalingModel

proc.Batch.combine
date: 17-Jan-2020 15:48:15
Done!
</pre><p><b>proc.Batch.scale</b></p><pre class="codeinput">[tf,errorMessage] = proc.Batch.scale(<span class="keyword">...</span>
    <span class="string">'workingDirectory'</span>,<span class="string">'proc'</span>,<span class="keyword">...</span>
    <span class="string">'scaleIn'</span>,<span class="string">'combine.mat'</span>,<span class="keyword">...</span>
    <span class="string">'bizMult'</span>,5,<span class="keyword">...</span><span class="comment"> % regularization parameter for smoothness of b</span>
    <span class="string">'program'</span>,{<span class="string">'b'</span>,50,1E-4,<span class="string">'o'</span>,[],10,<span class="string">'a'</span>,20,1E-3});

<span class="keyword">if</span> ~tf, rethrow(errorMessage);<span class="keyword">end</span>
</pre><pre class="codeoutput">
proc.Batch.scale
date: 17-Jan-2020 15:48:15
workingDirectory: proc
combineIn: combine.mat
scaleIn: combine.mat
matOut: scale.mat
logOut: scale.log
mergeByColumns: hasu, kasu, lasu
program: b, 50, 0.0001, o, [], 10, a, 20, 0.001
cMin: 0
bizMult: 5
csMult: 100
cizMult: 10
cMult: 0.001
aixiyMult: 10
aizMult: 1
dipMult: 0.01

  checking input file combine.mat
  reading workspace variables from file proc/combine.mat
    diffuseTable
  checking input file combine.mat
  reading workspace variables from file proc/combine.mat
    ScalingModel
  initializing proc.scale.MultiBatchScaler
  calculating regularization parameters
  refining scales
    refining scale vs. frame number
      1 of 50: x2 = 19.8571
      2 of 50: x2 = 18.8523
      3 of 50: x2 = 18.3843
      4 of 50: x2 = 18.1649
      5 of 50: x2 = 18.0612
      6 of 50: x2 = 18.0117
      7 of 50: x2 = 17.9876
      8 of 50: x2 = 17.9758
      9 of 50: x2 = 17.9698
      10 of 50: x2 = 17.9667
      11 of 50: x2 = 17.965
      12 of 50: x2 = 17.9641
      13 of 50: x2 = 17.9635
      14 of 50: x2 = 17.9632
      15 of 50: x2 = 17.963
      16 of 50: x2 = 17.9629
      17 of 50: x2 = 17.9628 &lt;-- reached tolerance
    removing outliers
      0 outliers removed from batch 1
    refining scale vs. frame number and detector position
      1 of 20: x2 = 17.523
      2 of 20: x2 = 17.4625
      3 of 20: x2 = 17.4456
      4 of 20: x2 = 17.4383
      5 of 20: x2 = 17.4345
      6 of 20: x2 = 17.4323
      7 of 20: x2 = 17.4308
      8 of 20: x2 = 17.4297
      9 of 20: x2 = 17.4288 &lt;-- reached tolerance
  done refining scales
  checking output file scale.mat

WARNING: Output file already exists and will be overwritten.

  saving workspace variables to file: proc/scale.mat
    options
    ScalingModel

proc.Batch.scale
date: 17-Jan-2020 15:48:15
Done!
</pre><h2 id="10">Plot of overall scale factor vs. frame number (b)</h2><pre class="codeinput">load <span class="string">proc/scale.mat</span> <span class="string">ScalingModel</span>

figure;plot(ScalingModel.Ia.wz,ScalingModel.b);
xlabel(<span class="string">'Frame Number'</span>);ylabel(<span class="string">'Scale Factor (b)'</span>);

clear <span class="string">ScalingModel</span>
</pre><img vspace="5" hspace="5" src="process_01.png" alt=""> <p><b>proc.Batch.merge</b></p><pre class="codeinput">[tf,errorMessage] = proc.Batch.merge(<span class="keyword">...</span>
    <span class="string">'workingDirectory'</span>,<span class="string">'proc'</span>);

<span class="keyword">if</span> ~tf, rethrow(errorMessage);<span class="keyword">end</span>
</pre><pre class="codeoutput">
proc.Batch.merge
date: 17-Jan-2020 15:48:17
workingDirectory: proc
combineIn: combine.mat
scaleIn: scale.mat
matOut: merge.mat
logOut: merge.log
mergeBragg: 0
sigmaCutoff: 5
mergeByColumns: hasu, kasu, lasu

  checking input file scale.mat
  reading workspace variables from file proc/scale.mat
    ScalingModel
  checking input file combine.mat
  reading workspace variables from file proc/combine.mat
    diffuseTable
  calculating scale factors
  scaling intensities
  merging intensities
  removing outliers
    mean reduced chi-squared of equivalent reflections (1 is ideal): 4.17476
    removing observations with abs(resid/sigma) &gt; 20.8738
    23 outliers removed, 16537 observations remaining
  merging intensities
  checking output file merge.mat

WARNING: Output file already exists and will be overwritten.

  saving workspace variables to file: proc/merge.mat
    options
    hklMerge
    ih
    isOutlier

proc.Batch.merge
date: 17-Jan-2020 15:48:17
Done!
</pre><h2 id="12">Plot of coarse map intensity vs. resolution (1/d)</h2><pre class="codeinput">load <span class="string">proc/merge.mat</span> <span class="string">hklMerge</span>

figure;plot(hklMerge.s,hklMerge.I,<span class="string">'.'</span>);
xlabel(<span class="string">'1/d (&Aring;^{-1})'</span>);ylabel(<span class="string">'Intensity'</span>);title(<span class="string">'Coarse Map intensity vs. resolution'</span>);
clear <span class="string">hklMerge</span>
</pre><img vspace="5" hspace="5" src="process_02.png" alt=""> <h2 id="13">Plot of coarse map intensity slice (l = 0)</h2><pre class="codeinput">load <span class="string">proc/merge.mat</span> <span class="string">hklMerge</span>

<span class="comment">% create 3D array from hkl table</span>
E2A = proc.script.ExpandTableToArray(<span class="keyword">...</span>
    <span class="string">'hklcols'</span>,{<span class="string">'hasu'</span>,<span class="string">'kasu'</span>,<span class="string">'lasu'</span>,<span class="string">'I'</span>},<span class="keyword">...</span>
    <span class="string">'SpaceGroup'</span>,symm.SpaceGroup(1),<span class="keyword">...</span>
    <span class="string">'symexpand'</span>,true,<span class="keyword">...</span>
    <span class="string">'ndiv'</span>,[1,1,1]);

[P,I] = E2A.run(hklMerge);
[~,~,nl0] = P.frac2ind(0,0,0);
[h,~,~] = P.ind2frac(1:P.N(1),0,0);
[~,k,~] = P.ind2frac(0,1:P.N(2),0);

figure;imagesc(h,k,I(:,:,nl0)');
xlabel(<span class="string">'h'</span>);ylabel(<span class="string">'k'</span>);title(<span class="string">'Coarse Map Intensity (l = 0)'</span>);colormap <span class="string">hot</span>;colorbar

clear <span class="string">h</span> <span class="string">k</span> <span class="string">nl0</span> <span class="string">P</span> <span class="string">I</span> <span class="string">E2A</span> <span class="string">hklMerge</span>
</pre><img vspace="5" hspace="5" src="process_03.png" alt=""> <h2 id="14">Integrate on a fine grid</h2><p><b>proc.Batch.grid</b></p><p>make a fine grid</p><pre class="codeinput">ndiv = [5,15,15]; <span class="comment">% number of divisions for the fine grid</span>

[tf,errorMessage] = proc.Batch.grid(<span class="keyword">...</span>
    <span class="string">'workingDirectory'</span>,<span class="string">'proc'</span>,<span class="keyword">...</span>
    <span class="string">'matOut'</span>,<span class="string">'grid.mat'</span>,<span class="keyword">...</span>
    <span class="string">'smax'</span>,Inf,<span class="keyword">...</span>
    <span class="string">'getSymmetryEquivalents'</span>,true,<span class="keyword">...</span>
    <span class="string">'ndiv'</span>,ndiv,<span class="keyword">...</span>
    <span class="string">'excludeBraggPosition'</span>,true,<span class="keyword">...</span>
    <span class="string">'parallel'</span>,false<span class="keyword">...</span><span class="comment"> % true requires parallel computing toolbox</span>
    );

<span class="keyword">if</span> ~tf, rethrow(errorMessage);<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: parallel is not a valid option 

proc.Batch.grid
date: 17-Jan-2020 15:48:18
workingDirectory: proc
geometryIn: geom.mat
matOut: grid.mat
logOut: grid.log
ndiv: [5 15 15]
smax: Inf
hLim: [-Inf Inf]
kLim: [-Inf Inf]
lLim: [-Inf Inf]
h: []
k: []
l: []
getSymmetryEquivalents: 1
excludeBraggPosition: 1

  checking input file geom.mat
  reading workspace variables from file proc/geom.mat
    InputGeometry
    RefinedGeometry
    InputImageSeries
    WedgeImageSeries
  reading first image (to update bad pixel mask)
  processing wedge 1 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 2 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 3 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 4 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 5 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 6 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 7 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 8 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 9 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 10 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 11 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 12 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 13 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 14 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 15 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 16 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 17 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 18 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 19 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 20 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 21 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 22 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 23 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 24 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 25 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 26 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 27 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 28 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 29 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 30 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 31 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 32 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 33 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 34 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 35 of 36
    initializing the Integrater
    initializing the reference grid
  processing wedge 36 of 36
    initializing the Integrater
    initializing the reference grid
  checking output file grid.mat

WARNING: Output file already exists and will be overwritten.

  saving workspace variables to file: proc/grid.mat
    options
    Grid
    pixelMask

proc.Batch.grid
date: 17-Jan-2020 15:48:19
Done!
</pre><p><b>proc.Batch.reintegrate</b></p><pre class="codeinput">[tf,errorMessage] = proc.Batch.reintegrate(<span class="keyword">...</span>
    <span class="string">'workingDirectory'</span>,<span class="string">'proc'</span>,<span class="keyword">...</span>
    <span class="string">'geometryIn'</span>,<span class="string">'geom.mat'</span>,<span class="keyword">...</span>
    <span class="string">'bkgGeometryIn'</span>,<span class="string">'geomBkg.mat'</span>,<span class="keyword">...</span>
    <span class="string">'gridIn'</span>,<span class="string">'grid.mat'</span>,<span class="keyword">...</span>
    <span class="string">'scaleIn'</span>,<span class="string">'scale.mat'</span>,<span class="keyword">...</span>
    <span class="string">'matOut'</span>,<span class="string">'reintegrate.mat'</span>,<span class="keyword">...</span>
    <span class="string">'logOut'</span>,<span class="string">'reintegrate.log'</span>,<span class="keyword">...</span>
    <span class="string">'minimumCounts'</span>,0,<span class="keyword">...</span>
    <span class="string">'minimumPixels'</span>,1,<span class="keyword">...</span>
    <span class="string">'parallel'</span>,false<span class="keyword">...</span><span class="comment"> % true requires parallel computing toolbox</span>
    );

<span class="keyword">if</span> ~tf, rethrow(errorMessage);<span class="keyword">end</span>
</pre><pre class="codeoutput">
proc.Batch.reintegrate
date: 17-Jan-2020 15:48:19
workingDirectory: proc
geometryIn: geom.mat
readBackground: 1
bkgGeometryIn: geomBkg.mat
gridIn: grid.mat
scaleIn: scale.mat
matOut: reintegrate.mat
logOut: reintegrate.log
exposureTimeField: Exposure_time
minimumCounts: 0
minimumPixels: 1
parallel: 0
binExcludedVoxels: 0

  checking input file geom.mat
  reading workspace variables from file proc/geom.mat
    InputGeometry
    RefinedGeometry
    InputImageSeries
    WedgeImageSeries
  checking input file grid.mat
  reading workspace variables from file proc/grid.mat
    Grid
    pixelMask
  checking input file scale.mat
  reading workspace variables from file proc/scale.mat
    ScalingModel
  checking input file geomBkg.mat
  reading workspace variables from file proc/geomBkg.mat
    InputImageSeries
    WedgeImageSeries
  processing wedge 1 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 2 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 3 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 4 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 5 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 6 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 7 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 8 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 9 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 10 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 11 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 12 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 13 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 14 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 15 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 16 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 17 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 18 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 19 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 20 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 21 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 22 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 23 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 24 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 25 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 26 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 27 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 28 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 29 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 30 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 31 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 32 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 33 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 34 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 35 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 36 of 36
    initializing the Integrater
    reading images and accumulating counts
  processing wedge 1 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 2 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 3 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 4 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 5 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 6 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 7 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 8 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 9 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 10 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 11 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 12 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 13 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 14 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 15 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 16 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 17 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 18 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 19 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 20 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 21 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 22 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 23 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 24 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 25 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 26 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 27 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 28 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 29 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 30 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 31 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 32 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 33 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 34 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 35 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  processing wedge 36 of 36
    initializing the Integrater
    calculating image corrections
    reading exposure times from crystal image headers
    reading background images
    calculating the pixel multiplicity
    accumulating image corrections
  checking output file reintegrate.mat

WARNING: Output file already exists and will be overwritten.

  saving workspace variables to file: proc/reintegrate.mat
    options
    diffuseTable
    AverageGeometry

proc.Batch.reintegrate
date: 17-Jan-2020 15:48:38
Done!
</pre><p><b>MergeScaledDiffuse</b></p><pre class="codeinput"><span class="comment">% get crystal info</span>
load <span class="string">proc/export.mat</span> <span class="string">AverageGeometry</span>

M = proc.script.MergeScaledDiffuse(<span class="keyword">...</span>
    <span class="string">'Grid'</span>,grid.Sub3d(<span class="string">'ndiv'</span>,ndiv),<span class="keyword">...</span>
    <span class="string">'Crystal'</span>,AverageGeometry.Crystal,<span class="keyword">...</span>
    <span class="string">'nMin'</span>,2,<span class="keyword">...</span>
    <span class="string">'workingDirectory'</span>,<span class="string">'proc'</span>);

AverageGeometry

<span class="comment">% run the script on reintegrate.mat</span>
fn = M.mapToColumns({<span class="string">'reintegrate.mat'</span>});

[hklMerge,isincl] = M.mergeColumns(fn);

<span class="comment">% save table to mat file</span>
save(<span class="string">'proc/mergeFine.mat'</span>,<span class="string">'hklMerge'</span>);

<span class="comment">% split and merge for calculating cc1/2, cc*</span>
rng(0,<span class="string">'twister'</span>); <span class="comment">% set random number generator for reproducibility</span>
[hklMerge] = M.mergeRandomHalfSets(fn,isincl);

save(<span class="string">'proc/mergeFineSplit.mat'</span>,<span class="string">'hklMerge'</span>);

M.clearTmp(fn); <span class="comment">% clear files from temporary directory</span>

clear <span class="string">hklMerge</span> <span class="string">isincl</span> <span class="string">M</span>
</pre><pre class="codeoutput">
AverageGeometry = 

  DiffractionExperiment with properties:

      Source: [1&times;1 geom.Source]
     Spindle: [1&times;1 geom.RotationSeries]
     Crystal: [1&times;1 geom.Crystal]
    Detector: [1&times;1 TinyDetector]

START
making temporary directory /private/var/folders/24/ns8c5m4j5pn5ws4d8j9pjr680000gn/T/mdx-kit-20200117154839
loading diffuseTable from proc/reintegrate.mat
  mapping hkl to asu
  get rows of diffuseTable to put in each binary file
  append to binary files
DONE: 1125 tmp files written (94.801 Mb total)
START: mergeColumns

processing file 1 of 1125
processing file 2 of 1125
processing file 3 of 1125
processing file 4 of 1125
processing file 5 of 1125
processing file 6 of 1125
processing file 7 of 1125
processing file 8 of 1125
processing file 9 of 1125
processing file 10 of 1125
processing file 11 of 1125
processing file 12 of 1125
processing file 13 of 1125
processing file 14 of 1125
processing file 15 of 1125
processing file 16 of 1125
processing file 17 of 1125
processing file 18 of 1125
processing file 19 of 1125
processing file 20 of 1125
processing file 21 of 1125
processing file 22 of 1125
processing file 23 of 1125
processing file 24 of 1125
processing file 25 of 1125
processing file 26 of 1125
processing file 27 of 1125
processing file 28 of 1125
processing file 29 of 1125
processing file 30 of 1125
processing file 31 of 1125
processing file 32 of 1125
processing file 33 of 1125
processing file 34 of 1125
processing file 35 of 1125
processing file 36 of 1125
processing file 37 of 1125
processing file 38 of 1125
processing file 39 of 1125
processing file 40 of 1125
processing file 41 of 1125
processing file 42 of 1125
processing file 43 of 1125
processing file 44 of 1125
processing file 45 of 1125
processing file 46 of 1125
processing file 47 of 1125
processing file 48 of 1125
processing file 49 of 1125
processing file 50 of 1125
processing file 51 of 1125
processing file 52 of 1125
processing file 53 of 1125
processing file 54 of 1125
processing file 55 of 1125
processing file 56 of 1125
processing file 57 of 1125
processing file 58 of 1125
processing file 59 of 1125
processing file 60 of 1125
processing file 61 of 1125
processing file 62 of 1125
processing file 63 of 1125
processing file 64 of 1125
processing file 65 of 1125
processing file 66 of 1125
processing file 67 of 1125
processing file 68 of 1125
processing file 69 of 1125
processing file 70 of 1125
processing file 71 of 1125
processing file 72 of 1125
processing file 73 of 1125
processing file 74 of 1125
processing file 75 of 1125
processing file 76 of 1125
processing file 77 of 1125
processing file 78 of 1125
processing file 79 of 1125
processing file 80 of 1125
processing file 81 of 1125
processing file 82 of 1125
processing file 83 of 1125
processing file 84 of 1125
processing file 85 of 1125
processing file 86 of 1125
processing file 87 of 1125
processing file 88 of 1125
processing file 89 of 1125
processing file 90 of 1125
processing file 91 of 1125
processing file 92 of 1125
processing file 93 of 1125
processing file 94 of 1125
processing file 95 of 1125
processing file 96 of 1125
processing file 97 of 1125
processing file 98 of 1125
processing file 99 of 1125
processing file 100 of 1125
processing file 101 of 1125
processing file 102 of 1125
processing file 103 of 1125
processing file 104 of 1125
processing file 105 of 1125
processing file 106 of 1125
processing file 107 of 1125
processing file 108 of 1125
processing file 109 of 1125
processing file 110 of 1125
processing file 111 of 1125
processing file 112 of 1125
processing file 113 of 1125
processing file 114 of 1125
processing file 115 of 1125
processing file 116 of 1125
processing file 117 of 1125
processing file 118 of 1125
processing file 119 of 1125
processing file 120 of 1125
processing file 121 of 1125
processing file 122 of 1125
processing file 123 of 1125
processing file 124 of 1125
processing file 125 of 1125
processing file 126 of 1125
processing file 127 of 1125
processing file 128 of 1125
processing file 129 of 1125
processing file 130 of 1125
processing file 131 of 1125
processing file 132 of 1125
processing file 133 of 1125
processing file 134 of 1125
processing file 135 of 1125
processing file 136 of 1125
processing file 137 of 1125
processing file 138 of 1125
processing file 139 of 1125
processing file 140 of 1125
processing file 141 of 1125
processing file 142 of 1125
processing file 143 of 1125
processing file 144 of 1125
processing file 145 of 1125
processing file 146 of 1125
processing file 147 of 1125
processing file 148 of 1125
processing file 149 of 1125
processing file 150 of 1125
processing file 151 of 1125
processing file 152 of 1125
processing file 153 of 1125
processing file 154 of 1125
processing file 155 of 1125
processing file 156 of 1125
processing file 157 of 1125
processing file 158 of 1125
processing file 159 of 1125
processing file 160 of 1125
processing file 161 of 1125
processing file 162 of 1125
processing file 163 of 1125
processing file 164 of 1125
processing file 165 of 1125
processing file 166 of 1125
processing file 167 of 1125
processing file 168 of 1125
processing file 169 of 1125
processing file 170 of 1125
processing file 171 of 1125
processing file 172 of 1125
processing file 173 of 1125
processing file 174 of 1125
processing file 175 of 1125
processing file 176 of 1125
processing file 177 of 1125
processing file 178 of 1125
processing file 179 of 1125
processing file 180 of 1125
processing file 181 of 1125
processing file 182 of 1125
processing file 183 of 1125
processing file 184 of 1125
processing file 185 of 1125
processing file 186 of 1125
processing file 187 of 1125
processing file 188 of 1125
processing file 189 of 1125
processing file 190 of 1125
processing file 191 of 1125
processing file 192 of 1125
processing file 193 of 1125
processing file 194 of 1125
processing file 195 of 1125
processing file 196 of 1125
processing file 197 of 1125
processing file 198 of 1125
processing file 199 of 1125
processing file 200 of 1125
processing file 201 of 1125
processing file 202 of 1125
processing file 203 of 1125
processing file 204 of 1125
processing file 205 of 1125
processing file 206 of 1125
processing file 207 of 1125
processing file 208 of 1125
processing file 209 of 1125
processing file 210 of 1125
processing file 211 of 1125
processing file 212 of 1125
processing file 213 of 1125
processing file 214 of 1125
processing file 215 of 1125
processing file 216 of 1125
processing file 217 of 1125
processing file 218 of 1125
processing file 219 of 1125
processing file 220 of 1125
processing file 221 of 1125
processing file 222 of 1125
processing file 223 of 1125
processing file 224 of 1125
processing file 225 of 1125
processing file 226 of 1125
processing file 227 of 1125
processing file 228 of 1125
processing file 229 of 1125
processing file 230 of 1125
processing file 231 of 1125
processing file 232 of 1125
processing file 233 of 1125
processing file 234 of 1125
processing file 235 of 1125
processing file 236 of 1125
processing file 237 of 1125
processing file 238 of 1125
processing file 239 of 1125
processing file 240 of 1125
processing file 241 of 1125
processing file 242 of 1125
processing file 243 of 1125
processing file 244 of 1125
processing file 245 of 1125
processing file 246 of 1125
processing file 247 of 1125
processing file 248 of 1125
processing file 249 of 1125
processing file 250 of 1125
processing file 251 of 1125
processing file 252 of 1125
processing file 253 of 1125
processing file 254 of 1125
processing file 255 of 1125
processing file 256 of 1125
processing file 257 of 1125
processing file 258 of 1125
processing file 259 of 1125
processing file 260 of 1125
processing file 261 of 1125
processing file 262 of 1125
processing file 263 of 1125
processing file 264 of 1125
processing file 265 of 1125
processing file 266 of 1125
processing file 267 of 1125
processing file 268 of 1125
processing file 269 of 1125
processing file 270 of 1125
processing file 271 of 1125
processing file 272 of 1125
processing file 273 of 1125
processing file 274 of 1125
processing file 275 of 1125
processing file 276 of 1125
processing file 277 of 1125
processing file 278 of 1125
processing file 279 of 1125
processing file 280 of 1125
processing file 281 of 1125
processing file 282 of 1125
processing file 283 of 1125
processing file 284 of 1125
processing file 285 of 1125
processing file 286 of 1125
processing file 287 of 1125
processing file 288 of 1125
processing file 289 of 1125
processing file 290 of 1125
processing file 291 of 1125
processing file 292 of 1125
processing file 293 of 1125
processing file 294 of 1125
processing file 295 of 1125
processing file 296 of 1125
processing file 297 of 1125
processing file 298 of 1125
processing file 299 of 1125
processing file 300 of 1125
processing file 301 of 1125
processing file 302 of 1125
processing file 303 of 1125
processing file 304 of 1125
processing file 305 of 1125
processing file 306 of 1125
processing file 307 of 1125
processing file 308 of 1125
processing file 309 of 1125
processing file 310 of 1125
processing file 311 of 1125
processing file 312 of 1125
processing file 313 of 1125
processing file 314 of 1125
processing file 315 of 1125
processing file 316 of 1125
processing file 317 of 1125
processing file 318 of 1125
processing file 319 of 1125
processing file 320 of 1125
processing file 321 of 1125
processing file 322 of 1125
processing file 323 of 1125
processing file 324 of 1125
processing file 325 of 1125
processing file 326 of 1125
processing file 327 of 1125
processing file 328 of 1125
processing file 329 of 1125
processing file 330 of 1125
processing file 331 of 1125
processing file 332 of 1125
processing file 333 of 1125
processing file 334 of 1125
processing file 335 of 1125
processing file 336 of 1125
processing file 337 of 1125
processing file 338 of 1125
processing file 339 of 1125
processing file 340 of 1125
processing file 341 of 1125
processing file 342 of 1125
processing file 343 of 1125
processing file 344 of 1125
processing file 345 of 1125
processing file 346 of 1125
processing file 347 of 1125
processing file 348 of 1125
processing file 349 of 1125
processing file 350 of 1125
processing file 351 of 1125
processing file 352 of 1125
processing file 353 of 1125
processing file 354 of 1125
processing file 355 of 1125
processing file 356 of 1125
processing file 357 of 1125
processing file 358 of 1125
processing file 359 of 1125
processing file 360 of 1125
processing file 361 of 1125
processing file 362 of 1125
processing file 363 of 1125
processing file 364 of 1125
processing file 365 of 1125
processing file 366 of 1125
processing file 367 of 1125
processing file 368 of 1125
processing file 369 of 1125
processing file 370 of 1125
processing file 371 of 1125
processing file 372 of 1125
processing file 373 of 1125
processing file 374 of 1125
processing file 375 of 1125
processing file 376 of 1125
processing file 377 of 1125
processing file 378 of 1125
processing file 379 of 1125
processing file 380 of 1125
processing file 381 of 1125
processing file 382 of 1125
processing file 383 of 1125
processing file 384 of 1125
processing file 385 of 1125
processing file 386 of 1125
processing file 387 of 1125
processing file 388 of 1125
processing file 389 of 1125
processing file 390 of 1125
processing file 391 of 1125
processing file 392 of 1125
processing file 393 of 1125
processing file 394 of 1125
processing file 395 of 1125
processing file 396 of 1125
processing file 397 of 1125
processing file 398 of 1125
processing file 399 of 1125
processing file 400 of 1125
processing file 401 of 1125
processing file 402 of 1125
processing file 403 of 1125
processing file 404 of 1125
processing file 405 of 1125
processing file 406 of 1125
processing file 407 of 1125
processing file 408 of 1125
processing file 409 of 1125
processing file 410 of 1125
processing file 411 of 1125
processing file 412 of 1125
processing file 413 of 1125
processing file 414 of 1125
processing file 415 of 1125
processing file 416 of 1125
processing file 417 of 1125
processing file 418 of 1125
processing file 419 of 1125
processing file 420 of 1125
processing file 421 of 1125
processing file 422 of 1125
processing file 423 of 1125
processing file 424 of 1125
processing file 425 of 1125
processing file 426 of 1125
processing file 427 of 1125
processing file 428 of 1125
processing file 429 of 1125
processing file 430 of 1125
processing file 431 of 1125
processing file 432 of 1125
processing file 433 of 1125
processing file 434 of 1125
processing file 435 of 1125
processing file 436 of 1125
processing file 437 of 1125
processing file 438 of 1125
processing file 439 of 1125
processing file 440 of 1125
processing file 441 of 1125
processing file 442 of 1125
processing file 443 of 1125
processing file 444 of 1125
processing file 445 of 1125
processing file 446 of 1125
processing file 447 of 1125
processing file 448 of 1125
processing file 449 of 1125
processing file 450 of 1125
processing file 451 of 1125
processing file 452 of 1125
processing file 453 of 1125
processing file 454 of 1125
processing file 455 of 1125
processing file 456 of 1125
processing file 457 of 1125
processing file 458 of 1125
processing file 459 of 1125
processing file 460 of 1125
processing file 461 of 1125
processing file 462 of 1125
processing file 463 of 1125
processing file 464 of 1125
processing file 465 of 1125
processing file 466 of 1125
processing file 467 of 1125
processing file 468 of 1125
processing file 469 of 1125
processing file 470 of 1125
processing file 471 of 1125
processing file 472 of 1125
processing file 473 of 1125
processing file 474 of 1125
processing file 475 of 1125
processing file 476 of 1125
processing file 477 of 1125
processing file 478 of 1125
processing file 479 of 1125
processing file 480 of 1125
processing file 481 of 1125
processing file 482 of 1125
processing file 483 of 1125
processing file 484 of 1125
processing file 485 of 1125
processing file 486 of 1125
processing file 487 of 1125
processing file 488 of 1125
processing file 489 of 1125
processing file 490 of 1125
processing file 491 of 1125
processing file 492 of 1125
processing file 493 of 1125
processing file 494 of 1125
processing file 495 of 1125
processing file 496 of 1125
processing file 497 of 1125
processing file 498 of 1125
processing file 499 of 1125
processing file 500 of 1125
processing file 501 of 1125
processing file 502 of 1125
processing file 503 of 1125
processing file 504 of 1125
processing file 505 of 1125
processing file 506 of 1125
processing file 507 of 1125
processing file 508 of 1125
processing file 509 of 1125
processing file 510 of 1125
processing file 511 of 1125
processing file 512 of 1125
processing file 513 of 1125
processing file 514 of 1125
processing file 515 of 1125
processing file 516 of 1125
processing file 517 of 1125
processing file 518 of 1125
processing file 519 of 1125
processing file 520 of 1125
processing file 521 of 1125
processing file 522 of 1125
processing file 523 of 1125
processing file 524 of 1125
processing file 525 of 1125
processing file 526 of 1125
processing file 527 of 1125
processing file 528 of 1125
processing file 529 of 1125
processing file 530 of 1125
processing file 531 of 1125
processing file 532 of 1125
processing file 533 of 1125
processing file 534 of 1125
processing file 535 of 1125
processing file 536 of 1125
processing file 537 of 1125
processing file 538 of 1125
processing file 539 of 1125
processing file 540 of 1125
processing file 541 of 1125
processing file 542 of 1125
processing file 543 of 1125
processing file 544 of 1125
processing file 545 of 1125
processing file 546 of 1125
processing file 547 of 1125
processing file 548 of 1125
processing file 549 of 1125
processing file 550 of 1125
processing file 551 of 1125
processing file 552 of 1125
processing file 553 of 1125
processing file 554 of 1125
processing file 555 of 1125
processing file 556 of 1125
processing file 557 of 1125
processing file 558 of 1125
processing file 559 of 1125
processing file 560 of 1125
processing file 561 of 1125
processing file 562 of 1125
processing file 563 of 1125
processing file 564 of 1125
processing file 565 of 1125
processing file 566 of 1125
processing file 567 of 1125
processing file 568 of 1125
processing file 569 of 1125
processing file 570 of 1125
processing file 571 of 1125
processing file 572 of 1125
processing file 573 of 1125
processing file 574 of 1125
processing file 575 of 1125
processing file 576 of 1125
processing file 577 of 1125
processing file 578 of 1125
processing file 579 of 1125
processing file 580 of 1125
processing file 581 of 1125
processing file 582 of 1125
processing file 583 of 1125
processing file 584 of 1125
processing file 585 of 1125
processing file 586 of 1125
processing file 587 of 1125
processing file 588 of 1125
processing file 589 of 1125
processing file 590 of 1125
processing file 591 of 1125
processing file 592 of 1125
processing file 593 of 1125
processing file 594 of 1125
processing file 595 of 1125
processing file 596 of 1125
processing file 597 of 1125
processing file 598 of 1125
processing file 599 of 1125
processing file 600 of 1125
processing file 601 of 1125
processing file 602 of 1125
processing file 603 of 1125
processing file 604 of 1125
processing file 605 of 1125
processing file 606 of 1125
processing file 607 of 1125
processing file 608 of 1125
processing file 609 of 1125
processing file 610 of 1125
processing file 611 of 1125
processing file 612 of 1125
processing file 613 of 1125
processing file 614 of 1125
processing file 615 of 1125
processing file 616 of 1125
processing file 617 of 1125
processing file 618 of 1125
processing file 619 of 1125
processing file 620 of 1125
processing file 621 of 1125
processing file 622 of 1125
processing file 623 of 1125
processing file 624 of 1125
processing file 625 of 1125
processing file 626 of 1125
processing file 627 of 1125
processing file 628 of 1125
processing file 629 of 1125
processing file 630 of 1125
processing file 631 of 1125
processing file 632 of 1125
processing file 633 of 1125
processing file 634 of 1125
processing file 635 of 1125
processing file 636 of 1125
processing file 637 of 1125
processing file 638 of 1125
processing file 639 of 1125
processing file 640 of 1125
processing file 641 of 1125
processing file 642 of 1125
processing file 643 of 1125
processing file 644 of 1125
processing file 645 of 1125
processing file 646 of 1125
processing file 647 of 1125
processing file 648 of 1125
processing file 649 of 1125
processing file 650 of 1125
processing file 651 of 1125
processing file 652 of 1125
processing file 653 of 1125
processing file 654 of 1125
processing file 655 of 1125
processing file 656 of 1125
processing file 657 of 1125
processing file 658 of 1125
processing file 659 of 1125
processing file 660 of 1125
processing file 661 of 1125
processing file 662 of 1125
processing file 663 of 1125
processing file 664 of 1125
processing file 665 of 1125
processing file 666 of 1125
processing file 667 of 1125
processing file 668 of 1125
processing file 669 of 1125
processing file 670 of 1125
processing file 671 of 1125
processing file 672 of 1125
processing file 673 of 1125
processing file 674 of 1125
processing file 675 of 1125
processing file 676 of 1125
processing file 677 of 1125
processing file 678 of 1125
processing file 679 of 1125
processing file 680 of 1125
processing file 681 of 1125
processing file 682 of 1125
processing file 683 of 1125
processing file 684 of 1125
processing file 685 of 1125
processing file 686 of 1125
processing file 687 of 1125
processing file 688 of 1125
processing file 689 of 1125
processing file 690 of 1125
processing file 691 of 1125
processing file 692 of 1125
processing file 693 of 1125
processing file 694 of 1125
processing file 695 of 1125
processing file 696 of 1125
processing file 697 of 1125
processing file 698 of 1125
processing file 699 of 1125
processing file 700 of 1125
processing file 701 of 1125
processing file 702 of 1125
processing file 703 of 1125
processing file 704 of 1125
processing file 705 of 1125
processing file 706 of 1125
processing file 707 of 1125
processing file 708 of 1125
processing file 709 of 1125
processing file 710 of 1125
processing file 711 of 1125
processing file 712 of 1125
processing file 713 of 1125
processing file 714 of 1125
processing file 715 of 1125
processing file 716 of 1125
processing file 717 of 1125
processing file 718 of 1125
processing file 719 of 1125
processing file 720 of 1125
processing file 721 of 1125
processing file 722 of 1125
processing file 723 of 1125
processing file 724 of 1125
processing file 725 of 1125
processing file 726 of 1125
processing file 727 of 1125
processing file 728 of 1125
processing file 729 of 1125
processing file 730 of 1125
processing file 731 of 1125
processing file 732 of 1125
processing file 733 of 1125
processing file 734 of 1125
processing file 735 of 1125
processing file 736 of 1125
processing file 737 of 1125
processing file 738 of 1125
processing file 739 of 1125
processing file 740 of 1125
processing file 741 of 1125
processing file 742 of 1125
processing file 743 of 1125
processing file 744 of 1125
processing file 745 of 1125
processing file 746 of 1125
processing file 747 of 1125
processing file 748 of 1125
processing file 749 of 1125
processing file 750 of 1125
processing file 751 of 1125
processing file 752 of 1125
processing file 753 of 1125
processing file 754 of 1125
processing file 755 of 1125
processing file 756 of 1125
processing file 757 of 1125
processing file 758 of 1125
processing file 759 of 1125
processing file 760 of 1125
processing file 761 of 1125
processing file 762 of 1125
processing file 763 of 1125
processing file 764 of 1125
processing file 765 of 1125
processing file 766 of 1125
processing file 767 of 1125
processing file 768 of 1125
processing file 769 of 1125
processing file 770 of 1125
processing file 771 of 1125
processing file 772 of 1125
processing file 773 of 1125
processing file 774 of 1125
processing file 775 of 1125
processing file 776 of 1125
processing file 777 of 1125
processing file 778 of 1125
processing file 779 of 1125
processing file 780 of 1125
processing file 781 of 1125
processing file 782 of 1125
processing file 783 of 1125
processing file 784 of 1125
processing file 785 of 1125
processing file 786 of 1125
processing file 787 of 1125
processing file 788 of 1125
processing file 789 of 1125
processing file 790 of 1125
processing file 791 of 1125
processing file 792 of 1125
processing file 793 of 1125
processing file 794 of 1125
processing file 795 of 1125
processing file 796 of 1125
processing file 797 of 1125
processing file 798 of 1125
processing file 799 of 1125
processing file 800 of 1125
processing file 801 of 1125
processing file 802 of 1125
processing file 803 of 1125
processing file 804 of 1125
processing file 805 of 1125
processing file 806 of 1125
processing file 807 of 1125
processing file 808 of 1125
processing file 809 of 1125
processing file 810 of 1125
processing file 811 of 1125
processing file 812 of 1125
processing file 813 of 1125
processing file 814 of 1125
processing file 815 of 1125
processing file 816 of 1125
processing file 817 of 1125
processing file 818 of 1125
processing file 819 of 1125
processing file 820 of 1125
processing file 821 of 1125
processing file 822 of 1125
processing file 823 of 1125
processing file 824 of 1125
processing file 825 of 1125
processing file 826 of 1125
processing file 827 of 1125
processing file 828 of 1125
processing file 829 of 1125
processing file 830 of 1125
processing file 831 of 1125
processing file 832 of 1125
processing file 833 of 1125
processing file 834 of 1125
processing file 835 of 1125
processing file 836 of 1125
processing file 837 of 1125
processing file 838 of 1125
processing file 839 of 1125
processing file 840 of 1125
processing file 841 of 1125
processing file 842 of 1125
processing file 843 of 1125
processing file 844 of 1125
processing file 845 of 1125
processing file 846 of 1125
processing file 847 of 1125
processing file 848 of 1125
processing file 849 of 1125
processing file 850 of 1125
processing file 851 of 1125
processing file 852 of 1125
processing file 853 of 1125
processing file 854 of 1125
processing file 855 of 1125
processing file 856 of 1125
processing file 857 of 1125
processing file 858 of 1125
processing file 859 of 1125
processing file 860 of 1125
processing file 861 of 1125
processing file 862 of 1125
processing file 863 of 1125
processing file 864 of 1125
processing file 865 of 1125
processing file 866 of 1125
processing file 867 of 1125
processing file 868 of 1125
processing file 869 of 1125
processing file 870 of 1125
processing file 871 of 1125
processing file 872 of 1125
processing file 873 of 1125
processing file 874 of 1125
processing file 875 of 1125
processing file 876 of 1125
processing file 877 of 1125
processing file 878 of 1125
processing file 879 of 1125
processing file 880 of 1125
processing file 881 of 1125
processing file 882 of 1125
processing file 883 of 1125
processing file 884 of 1125
processing file 885 of 1125
processing file 886 of 1125
processing file 887 of 1125
processing file 888 of 1125
processing file 889 of 1125
processing file 890 of 1125
processing file 891 of 1125
processing file 892 of 1125
processing file 893 of 1125
processing file 894 of 1125
processing file 895 of 1125
processing file 896 of 1125
processing file 897 of 1125
processing file 898 of 1125
processing file 899 of 1125
processing file 900 of 1125
processing file 901 of 1125
processing file 902 of 1125
processing file 903 of 1125
processing file 904 of 1125
processing file 905 of 1125
processing file 906 of 1125
processing file 907 of 1125
processing file 908 of 1125
processing file 909 of 1125
processing file 910 of 1125
processing file 911 of 1125
processing file 912 of 1125
processing file 913 of 1125
processing file 914 of 1125
processing file 915 of 1125
processing file 916 of 1125
processing file 917 of 1125
processing file 918 of 1125
processing file 919 of 1125
processing file 920 of 1125
processing file 921 of 1125
processing file 922 of 1125
processing file 923 of 1125
processing file 924 of 1125
processing file 925 of 1125
processing file 926 of 1125
processing file 927 of 1125
processing file 928 of 1125
processing file 929 of 1125
processing file 930 of 1125
processing file 931 of 1125
processing file 932 of 1125
processing file 933 of 1125
processing file 934 of 1125
processing file 935 of 1125
processing file 936 of 1125
processing file 937 of 1125
processing file 938 of 1125
processing file 939 of 1125
processing file 940 of 1125
processing file 941 of 1125
processing file 942 of 1125
processing file 943 of 1125
processing file 944 of 1125
processing file 945 of 1125
processing file 946 of 1125
processing file 947 of 1125
processing file 948 of 1125
processing file 949 of 1125
processing file 950 of 1125
processing file 951 of 1125
processing file 952 of 1125
processing file 953 of 1125
processing file 954 of 1125
processing file 955 of 1125
processing file 956 of 1125
processing file 957 of 1125
processing file 958 of 1125
processing file 959 of 1125
processing file 960 of 1125
processing file 961 of 1125
processing file 962 of 1125
processing file 963 of 1125
processing file 964 of 1125
processing file 965 of 1125
processing file 966 of 1125
processing file 967 of 1125
processing file 968 of 1125
processing file 969 of 1125
processing file 970 of 1125
processing file 971 of 1125
processing file 972 of 1125
processing file 973 of 1125
processing file 974 of 1125
processing file 975 of 1125
processing file 976 of 1125
processing file 977 of 1125
processing file 978 of 1125
processing file 979 of 1125
processing file 980 of 1125
processing file 981 of 1125
processing file 982 of 1125
processing file 983 of 1125
processing file 984 of 1125
processing file 985 of 1125
processing file 986 of 1125
processing file 987 of 1125
processing file 988 of 1125
processing file 989 of 1125
processing file 990 of 1125
processing file 991 of 1125
processing file 992 of 1125
processing file 993 of 1125
processing file 994 of 1125
processing file 995 of 1125
processing file 996 of 1125
processing file 997 of 1125
processing file 998 of 1125
processing file 999 of 1125
processing file 1000 of 1125
processing file 1001 of 1125
processing file 1002 of 1125
processing file 1003 of 1125
processing file 1004 of 1125
processing file 1005 of 1125
processing file 1006 of 1125
processing file 1007 of 1125
processing file 1008 of 1125
processing file 1009 of 1125
processing file 1010 of 1125
processing file 1011 of 1125
processing file 1012 of 1125
processing file 1013 of 1125
processing file 1014 of 1125
processing file 1015 of 1125
processing file 1016 of 1125
processing file 1017 of 1125
processing file 1018 of 1125
processing file 1019 of 1125
processing file 1020 of 1125
processing file 1021 of 1125
processing file 1022 of 1125
processing file 1023 of 1125
processing file 1024 of 1125
processing file 1025 of 1125
processing file 1026 of 1125
processing file 1027 of 1125
processing file 1028 of 1125
processing file 1029 of 1125
processing file 1030 of 1125
processing file 1031 of 1125
processing file 1032 of 1125
processing file 1033 of 1125
processing file 1034 of 1125
processing file 1035 of 1125
processing file 1036 of 1125
processing file 1037 of 1125
processing file 1038 of 1125
processing file 1039 of 1125
processing file 1040 of 1125
processing file 1041 of 1125
processing file 1042 of 1125
processing file 1043 of 1125
processing file 1044 of 1125
processing file 1045 of 1125
processing file 1046 of 1125
processing file 1047 of 1125
processing file 1048 of 1125
processing file 1049 of 1125
processing file 1050 of 1125
processing file 1051 of 1125
processing file 1052 of 1125
processing file 1053 of 1125
processing file 1054 of 1125
processing file 1055 of 1125
processing file 1056 of 1125
processing file 1057 of 1125
processing file 1058 of 1125
processing file 1059 of 1125
processing file 1060 of 1125
processing file 1061 of 1125
processing file 1062 of 1125
processing file 1063 of 1125
processing file 1064 of 1125
processing file 1065 of 1125
processing file 1066 of 1125
processing file 1067 of 1125
processing file 1068 of 1125
processing file 1069 of 1125
processing file 1070 of 1125
processing file 1071 of 1125
processing file 1072 of 1125
processing file 1073 of 1125
processing file 1074 of 1125
processing file 1075 of 1125
processing file 1076 of 1125
processing file 1077 of 1125
processing file 1078 of 1125
processing file 1079 of 1125
processing file 1080 of 1125
processing file 1081 of 1125
processing file 1082 of 1125
processing file 1083 of 1125
processing file 1084 of 1125
processing file 1085 of 1125
processing file 1086 of 1125
processing file 1087 of 1125
processing file 1088 of 1125
processing file 1089 of 1125
processing file 1090 of 1125
processing file 1091 of 1125
processing file 1092 of 1125
processing file 1093 of 1125
processing file 1094 of 1125
processing file 1095 of 1125
processing file 1096 of 1125
processing file 1097 of 1125
processing file 1098 of 1125
processing file 1099 of 1125
processing file 1100 of 1125
processing file 1101 of 1125
processing file 1102 of 1125
processing file 1103 of 1125
processing file 1104 of 1125
processing file 1105 of 1125
processing file 1106 of 1125
processing file 1107 of 1125
processing file 1108 of 1125
processing file 1109 of 1125
processing file 1110 of 1125
processing file 1111 of 1125
processing file 1112 of 1125
processing file 1113 of 1125
processing file 1114 of 1125
processing file 1115 of 1125
processing file 1116 of 1125
processing file 1117 of 1125
processing file 1118 of 1125
processing file 1119 of 1125
processing file 1120 of 1125
processing file 1121 of 1125
processing file 1122 of 1125
processing file 1123 of 1125
processing file 1124 of 1125
processing file 1125 of 1125
constructing hklTable
sorting hklTable
DONE: 3950028 reflections, 1266 rejected, merged to 981296
START: mergeRandomHalfSets

processing file 1 of 1125
processing file 2 of 1125
processing file 3 of 1125
processing file 4 of 1125
processing file 5 of 1125
processing file 6 of 1125
processing file 7 of 1125
processing file 8 of 1125
processing file 9 of 1125
processing file 10 of 1125
processing file 11 of 1125
processing file 12 of 1125
processing file 13 of 1125
processing file 14 of 1125
processing file 15 of 1125
processing file 16 of 1125
processing file 17 of 1125
processing file 18 of 1125
processing file 19 of 1125
processing file 20 of 1125
processing file 21 of 1125
processing file 22 of 1125
processing file 23 of 1125
processing file 24 of 1125
processing file 25 of 1125
processing file 26 of 1125
processing file 27 of 1125
processing file 28 of 1125
processing file 29 of 1125
processing file 30 of 1125
processing file 31 of 1125
processing file 32 of 1125
processing file 33 of 1125
processing file 34 of 1125
processing file 35 of 1125
processing file 36 of 1125
processing file 37 of 1125
processing file 38 of 1125
processing file 39 of 1125
processing file 40 of 1125
processing file 41 of 1125
processing file 42 of 1125
processing file 43 of 1125
processing file 44 of 1125
processing file 45 of 1125
processing file 46 of 1125
processing file 47 of 1125
processing file 48 of 1125
processing file 49 of 1125
processing file 50 of 1125
processing file 51 of 1125
processing file 52 of 1125
processing file 53 of 1125
processing file 54 of 1125
processing file 55 of 1125
processing file 56 of 1125
processing file 57 of 1125
processing file 58 of 1125
processing file 59 of 1125
processing file 60 of 1125
processing file 61 of 1125
processing file 62 of 1125
processing file 63 of 1125
processing file 64 of 1125
processing file 65 of 1125
processing file 66 of 1125
processing file 67 of 1125
processing file 68 of 1125
processing file 69 of 1125
processing file 70 of 1125
processing file 71 of 1125
processing file 72 of 1125
processing file 73 of 1125
processing file 74 of 1125
processing file 75 of 1125
processing file 76 of 1125
processing file 77 of 1125
processing file 78 of 1125
processing file 79 of 1125
processing file 80 of 1125
processing file 81 of 1125
processing file 82 of 1125
processing file 83 of 1125
processing file 84 of 1125
processing file 85 of 1125
processing file 86 of 1125
processing file 87 of 1125
processing file 88 of 1125
processing file 89 of 1125
processing file 90 of 1125
processing file 91 of 1125
processing file 92 of 1125
processing file 93 of 1125
processing file 94 of 1125
processing file 95 of 1125
processing file 96 of 1125
processing file 97 of 1125
processing file 98 of 1125
processing file 99 of 1125
processing file 100 of 1125
processing file 101 of 1125
processing file 102 of 1125
processing file 103 of 1125
processing file 104 of 1125
processing file 105 of 1125
processing file 106 of 1125
processing file 107 of 1125
processing file 108 of 1125
processing file 109 of 1125
processing file 110 of 1125
processing file 111 of 1125
processing file 112 of 1125
processing file 113 of 1125
processing file 114 of 1125
processing file 115 of 1125
processing file 116 of 1125
processing file 117 of 1125
processing file 118 of 1125
processing file 119 of 1125
processing file 120 of 1125
processing file 121 of 1125
processing file 122 of 1125
processing file 123 of 1125
processing file 124 of 1125
processing file 125 of 1125
processing file 126 of 1125
processing file 127 of 1125
processing file 128 of 1125
processing file 129 of 1125
processing file 130 of 1125
processing file 131 of 1125
processing file 132 of 1125
processing file 133 of 1125
processing file 134 of 1125
processing file 135 of 1125
processing file 136 of 1125
processing file 137 of 1125
processing file 138 of 1125
processing file 139 of 1125
processing file 140 of 1125
processing file 141 of 1125
processing file 142 of 1125
processing file 143 of 1125
processing file 144 of 1125
processing file 145 of 1125
processing file 146 of 1125
processing file 147 of 1125
processing file 148 of 1125
processing file 149 of 1125
processing file 150 of 1125
processing file 151 of 1125
processing file 152 of 1125
processing file 153 of 1125
processing file 154 of 1125
processing file 155 of 1125
processing file 156 of 1125
processing file 157 of 1125
processing file 158 of 1125
processing file 159 of 1125
processing file 160 of 1125
processing file 161 of 1125
processing file 162 of 1125
processing file 163 of 1125
processing file 164 of 1125
processing file 165 of 1125
processing file 166 of 1125
processing file 167 of 1125
processing file 168 of 1125
processing file 169 of 1125
processing file 170 of 1125
processing file 171 of 1125
processing file 172 of 1125
processing file 173 of 1125
processing file 174 of 1125
processing file 175 of 1125
processing file 176 of 1125
processing file 177 of 1125
processing file 178 of 1125
processing file 179 of 1125
processing file 180 of 1125
processing file 181 of 1125
processing file 182 of 1125
processing file 183 of 1125
processing file 184 of 1125
processing file 185 of 1125
processing file 186 of 1125
processing file 187 of 1125
processing file 188 of 1125
processing file 189 of 1125
processing file 190 of 1125
processing file 191 of 1125
processing file 192 of 1125
processing file 193 of 1125
processing file 194 of 1125
processing file 195 of 1125
processing file 196 of 1125
processing file 197 of 1125
processing file 198 of 1125
processing file 199 of 1125
processing file 200 of 1125
processing file 201 of 1125
processing file 202 of 1125
processing file 203 of 1125
processing file 204 of 1125
processing file 205 of 1125
processing file 206 of 1125
processing file 207 of 1125
processing file 208 of 1125
processing file 209 of 1125
processing file 210 of 1125
processing file 211 of 1125
processing file 212 of 1125
processing file 213 of 1125
processing file 214 of 1125
processing file 215 of 1125
processing file 216 of 1125
processing file 217 of 1125
processing file 218 of 1125
processing file 219 of 1125
processing file 220 of 1125
processing file 221 of 1125
processing file 222 of 1125
processing file 223 of 1125
processing file 224 of 1125
processing file 225 of 1125
processing file 226 of 1125
processing file 227 of 1125
processing file 228 of 1125
processing file 229 of 1125
processing file 230 of 1125
processing file 231 of 1125
processing file 232 of 1125
processing file 233 of 1125
processing file 234 of 1125
processing file 235 of 1125
processing file 236 of 1125
processing file 237 of 1125
processing file 238 of 1125
processing file 239 of 1125
processing file 240 of 1125
processing file 241 of 1125
processing file 242 of 1125
processing file 243 of 1125
processing file 244 of 1125
processing file 245 of 1125
processing file 246 of 1125
processing file 247 of 1125
processing file 248 of 1125
processing file 249 of 1125
processing file 250 of 1125
processing file 251 of 1125
processing file 252 of 1125
processing file 253 of 1125
processing file 254 of 1125
processing file 255 of 1125
processing file 256 of 1125
processing file 257 of 1125
processing file 258 of 1125
processing file 259 of 1125
processing file 260 of 1125
processing file 261 of 1125
processing file 262 of 1125
processing file 263 of 1125
processing file 264 of 1125
processing file 265 of 1125
processing file 266 of 1125
processing file 267 of 1125
processing file 268 of 1125
processing file 269 of 1125
processing file 270 of 1125
processing file 271 of 1125
processing file 272 of 1125
processing file 273 of 1125
processing file 274 of 1125
processing file 275 of 1125
processing file 276 of 1125
processing file 277 of 1125
processing file 278 of 1125
processing file 279 of 1125
processing file 280 of 1125
processing file 281 of 1125
processing file 282 of 1125
processing file 283 of 1125
processing file 284 of 1125
processing file 285 of 1125
processing file 286 of 1125
processing file 287 of 1125
processing file 288 of 1125
processing file 289 of 1125
processing file 290 of 1125
processing file 291 of 1125
processing file 292 of 1125
processing file 293 of 1125
processing file 294 of 1125
processing file 295 of 1125
processing file 296 of 1125
processing file 297 of 1125
processing file 298 of 1125
processing file 299 of 1125
processing file 300 of 1125
processing file 301 of 1125
processing file 302 of 1125
processing file 303 of 1125
processing file 304 of 1125
processing file 305 of 1125
processing file 306 of 1125
processing file 307 of 1125
processing file 308 of 1125
processing file 309 of 1125
processing file 310 of 1125
processing file 311 of 1125
processing file 312 of 1125
processing file 313 of 1125
processing file 314 of 1125
processing file 315 of 1125
processing file 316 of 1125
processing file 317 of 1125
processing file 318 of 1125
processing file 319 of 1125
processing file 320 of 1125
processing file 321 of 1125
processing file 322 of 1125
processing file 323 of 1125
processing file 324 of 1125
processing file 325 of 1125
processing file 326 of 1125
processing file 327 of 1125
processing file 328 of 1125
processing file 329 of 1125
processing file 330 of 1125
processing file 331 of 1125
processing file 332 of 1125
processing file 333 of 1125
processing file 334 of 1125
processing file 335 of 1125
processing file 336 of 1125
processing file 337 of 1125
processing file 338 of 1125
processing file 339 of 1125
processing file 340 of 1125
processing file 341 of 1125
processing file 342 of 1125
processing file 343 of 1125
processing file 344 of 1125
processing file 345 of 1125
processing file 346 of 1125
processing file 347 of 1125
processing file 348 of 1125
processing file 349 of 1125
processing file 350 of 1125
processing file 351 of 1125
processing file 352 of 1125
processing file 353 of 1125
processing file 354 of 1125
processing file 355 of 1125
processing file 356 of 1125
processing file 357 of 1125
processing file 358 of 1125
processing file 359 of 1125
processing file 360 of 1125
processing file 361 of 1125
processing file 362 of 1125
processing file 363 of 1125
processing file 364 of 1125
processing file 365 of 1125
processing file 366 of 1125
processing file 367 of 1125
processing file 368 of 1125
processing file 369 of 1125
processing file 370 of 1125
processing file 371 of 1125
processing file 372 of 1125
processing file 373 of 1125
processing file 374 of 1125
processing file 375 of 1125
processing file 376 of 1125
processing file 377 of 1125
processing file 378 of 1125
processing file 379 of 1125
processing file 380 of 1125
processing file 381 of 1125
processing file 382 of 1125
processing file 383 of 1125
processing file 384 of 1125
processing file 385 of 1125
processing file 386 of 1125
processing file 387 of 1125
processing file 388 of 1125
processing file 389 of 1125
processing file 390 of 1125
processing file 391 of 1125
processing file 392 of 1125
processing file 393 of 1125
processing file 394 of 1125
processing file 395 of 1125
processing file 396 of 1125
processing file 397 of 1125
processing file 398 of 1125
processing file 399 of 1125
processing file 400 of 1125
processing file 401 of 1125
processing file 402 of 1125
processing file 403 of 1125
processing file 404 of 1125
processing file 405 of 1125
processing file 406 of 1125
processing file 407 of 1125
processing file 408 of 1125
processing file 409 of 1125
processing file 410 of 1125
processing file 411 of 1125
processing file 412 of 1125
processing file 413 of 1125
processing file 414 of 1125
processing file 415 of 1125
processing file 416 of 1125
processing file 417 of 1125
processing file 418 of 1125
processing file 419 of 1125
processing file 420 of 1125
processing file 421 of 1125
processing file 422 of 1125
processing file 423 of 1125
processing file 424 of 1125
processing file 425 of 1125
processing file 426 of 1125
processing file 427 of 1125
processing file 428 of 1125
processing file 429 of 1125
processing file 430 of 1125
processing file 431 of 1125
processing file 432 of 1125
processing file 433 of 1125
processing file 434 of 1125
processing file 435 of 1125
processing file 436 of 1125
processing file 437 of 1125
processing file 438 of 1125
processing file 439 of 1125
processing file 440 of 1125
processing file 441 of 1125
processing file 442 of 1125
processing file 443 of 1125
processing file 444 of 1125
processing file 445 of 1125
processing file 446 of 1125
processing file 447 of 1125
processing file 448 of 1125
processing file 449 of 1125
processing file 450 of 1125
processing file 451 of 1125
processing file 452 of 1125
processing file 453 of 1125
processing file 454 of 1125
processing file 455 of 1125
processing file 456 of 1125
processing file 457 of 1125
processing file 458 of 1125
processing file 459 of 1125
processing file 460 of 1125
processing file 461 of 1125
processing file 462 of 1125
processing file 463 of 1125
processing file 464 of 1125
processing file 465 of 1125
processing file 466 of 1125
processing file 467 of 1125
processing file 468 of 1125
processing file 469 of 1125
processing file 470 of 1125
processing file 471 of 1125
processing file 472 of 1125
processing file 473 of 1125
processing file 474 of 1125
processing file 475 of 1125
processing file 476 of 1125
processing file 477 of 1125
processing file 478 of 1125
processing file 479 of 1125
processing file 480 of 1125
processing file 481 of 1125
processing file 482 of 1125
processing file 483 of 1125
processing file 484 of 1125
processing file 485 of 1125
processing file 486 of 1125
processing file 487 of 1125
processing file 488 of 1125
processing file 489 of 1125
processing file 490 of 1125
processing file 491 of 1125
processing file 492 of 1125
processing file 493 of 1125
processing file 494 of 1125
processing file 495 of 1125
processing file 496 of 1125
processing file 497 of 1125
processing file 498 of 1125
processing file 499 of 1125
processing file 500 of 1125
processing file 501 of 1125
processing file 502 of 1125
processing file 503 of 1125
processing file 504 of 1125
processing file 505 of 1125
processing file 506 of 1125
processing file 507 of 1125
processing file 508 of 1125
processing file 509 of 1125
processing file 510 of 1125
processing file 511 of 1125
processing file 512 of 1125
processing file 513 of 1125
processing file 514 of 1125
processing file 515 of 1125
processing file 516 of 1125
processing file 517 of 1125
processing file 518 of 1125
processing file 519 of 1125
processing file 520 of 1125
processing file 521 of 1125
processing file 522 of 1125
processing file 523 of 1125
processing file 524 of 1125
processing file 525 of 1125
processing file 526 of 1125
processing file 527 of 1125
processing file 528 of 1125
processing file 529 of 1125
processing file 530 of 1125
processing file 531 of 1125
processing file 532 of 1125
processing file 533 of 1125
processing file 534 of 1125
processing file 535 of 1125
processing file 536 of 1125
processing file 537 of 1125
processing file 538 of 1125
processing file 539 of 1125
processing file 540 of 1125
processing file 541 of 1125
processing file 542 of 1125
processing file 543 of 1125
processing file 544 of 1125
processing file 545 of 1125
processing file 546 of 1125
processing file 547 of 1125
processing file 548 of 1125
processing file 549 of 1125
processing file 550 of 1125
processing file 551 of 1125
processing file 552 of 1125
processing file 553 of 1125
processing file 554 of 1125
processing file 555 of 1125
processing file 556 of 1125
processing file 557 of 1125
processing file 558 of 1125
processing file 559 of 1125
processing file 560 of 1125
processing file 561 of 1125
processing file 562 of 1125
processing file 563 of 1125
processing file 564 of 1125
processing file 565 of 1125
processing file 566 of 1125
processing file 567 of 1125
processing file 568 of 1125
processing file 569 of 1125
processing file 570 of 1125
processing file 571 of 1125
processing file 572 of 1125
processing file 573 of 1125
processing file 574 of 1125
processing file 575 of 1125
processing file 576 of 1125
processing file 577 of 1125
processing file 578 of 1125
processing file 579 of 1125
processing file 580 of 1125
processing file 581 of 1125
processing file 582 of 1125
processing file 583 of 1125
processing file 584 of 1125
processing file 585 of 1125
processing file 586 of 1125
processing file 587 of 1125
processing file 588 of 1125
processing file 589 of 1125
processing file 590 of 1125
processing file 591 of 1125
processing file 592 of 1125
processing file 593 of 1125
processing file 594 of 1125
processing file 595 of 1125
processing file 596 of 1125
processing file 597 of 1125
processing file 598 of 1125
processing file 599 of 1125
processing file 600 of 1125
processing file 601 of 1125
processing file 602 of 1125
processing file 603 of 1125
processing file 604 of 1125
processing file 605 of 1125
processing file 606 of 1125
processing file 607 of 1125
processing file 608 of 1125
processing file 609 of 1125
processing file 610 of 1125
processing file 611 of 1125
processing file 612 of 1125
processing file 613 of 1125
processing file 614 of 1125
processing file 615 of 1125
processing file 616 of 1125
processing file 617 of 1125
processing file 618 of 1125
processing file 619 of 1125
processing file 620 of 1125
processing file 621 of 1125
processing file 622 of 1125
processing file 623 of 1125
processing file 624 of 1125
processing file 625 of 1125
processing file 626 of 1125
processing file 627 of 1125
processing file 628 of 1125
processing file 629 of 1125
processing file 630 of 1125
processing file 631 of 1125
processing file 632 of 1125
processing file 633 of 1125
processing file 634 of 1125
processing file 635 of 1125
processing file 636 of 1125
processing file 637 of 1125
processing file 638 of 1125
processing file 639 of 1125
processing file 640 of 1125
processing file 641 of 1125
processing file 642 of 1125
processing file 643 of 1125
processing file 644 of 1125
processing file 645 of 1125
processing file 646 of 1125
processing file 647 of 1125
processing file 648 of 1125
processing file 649 of 1125
processing file 650 of 1125
processing file 651 of 1125
processing file 652 of 1125
processing file 653 of 1125
processing file 654 of 1125
processing file 655 of 1125
processing file 656 of 1125
processing file 657 of 1125
processing file 658 of 1125
processing file 659 of 1125
processing file 660 of 1125
processing file 661 of 1125
processing file 662 of 1125
processing file 663 of 1125
processing file 664 of 1125
processing file 665 of 1125
processing file 666 of 1125
processing file 667 of 1125
processing file 668 of 1125
processing file 669 of 1125
processing file 670 of 1125
processing file 671 of 1125
processing file 672 of 1125
processing file 673 of 1125
processing file 674 of 1125
processing file 675 of 1125
processing file 676 of 1125
processing file 677 of 1125
processing file 678 of 1125
processing file 679 of 1125
processing file 680 of 1125
processing file 681 of 1125
processing file 682 of 1125
processing file 683 of 1125
processing file 684 of 1125
processing file 685 of 1125
processing file 686 of 1125
processing file 687 of 1125
processing file 688 of 1125
processing file 689 of 1125
processing file 690 of 1125
processing file 691 of 1125
processing file 692 of 1125
processing file 693 of 1125
processing file 694 of 1125
processing file 695 of 1125
processing file 696 of 1125
processing file 697 of 1125
processing file 698 of 1125
processing file 699 of 1125
processing file 700 of 1125
processing file 701 of 1125
processing file 702 of 1125
processing file 703 of 1125
processing file 704 of 1125
processing file 705 of 1125
processing file 706 of 1125
processing file 707 of 1125
processing file 708 of 1125
processing file 709 of 1125
processing file 710 of 1125
processing file 711 of 1125
processing file 712 of 1125
processing file 713 of 1125
processing file 714 of 1125
processing file 715 of 1125
processing file 716 of 1125
processing file 717 of 1125
processing file 718 of 1125
processing file 719 of 1125
processing file 720 of 1125
processing file 721 of 1125
processing file 722 of 1125
processing file 723 of 1125
processing file 724 of 1125
processing file 725 of 1125
processing file 726 of 1125
processing file 727 of 1125
processing file 728 of 1125
processing file 729 of 1125
processing file 730 of 1125
processing file 731 of 1125
processing file 732 of 1125
processing file 733 of 1125
processing file 734 of 1125
processing file 735 of 1125
processing file 736 of 1125
processing file 737 of 1125
processing file 738 of 1125
processing file 739 of 1125
processing file 740 of 1125
processing file 741 of 1125
processing file 742 of 1125
processing file 743 of 1125
processing file 744 of 1125
processing file 745 of 1125
processing file 746 of 1125
processing file 747 of 1125
processing file 748 of 1125
processing file 749 of 1125
processing file 750 of 1125
processing file 751 of 1125
processing file 752 of 1125
processing file 753 of 1125
processing file 754 of 1125
processing file 755 of 1125
processing file 756 of 1125
processing file 757 of 1125
processing file 758 of 1125
processing file 759 of 1125
processing file 760 of 1125
processing file 761 of 1125
processing file 762 of 1125
processing file 763 of 1125
processing file 764 of 1125
processing file 765 of 1125
processing file 766 of 1125
processing file 767 of 1125
processing file 768 of 1125
processing file 769 of 1125
processing file 770 of 1125
processing file 771 of 1125
processing file 772 of 1125
processing file 773 of 1125
processing file 774 of 1125
processing file 775 of 1125
processing file 776 of 1125
processing file 777 of 1125
processing file 778 of 1125
processing file 779 of 1125
processing file 780 of 1125
processing file 781 of 1125
processing file 782 of 1125
processing file 783 of 1125
processing file 784 of 1125
processing file 785 of 1125
processing file 786 of 1125
processing file 787 of 1125
processing file 788 of 1125
processing file 789 of 1125
processing file 790 of 1125
processing file 791 of 1125
processing file 792 of 1125
processing file 793 of 1125
processing file 794 of 1125
processing file 795 of 1125
processing file 796 of 1125
processing file 797 of 1125
processing file 798 of 1125
processing file 799 of 1125
processing file 800 of 1125
processing file 801 of 1125
processing file 802 of 1125
processing file 803 of 1125
processing file 804 of 1125
processing file 805 of 1125
processing file 806 of 1125
processing file 807 of 1125
processing file 808 of 1125
processing file 809 of 1125
processing file 810 of 1125
processing file 811 of 1125
processing file 812 of 1125
processing file 813 of 1125
processing file 814 of 1125
processing file 815 of 1125
processing file 816 of 1125
processing file 817 of 1125
processing file 818 of 1125
processing file 819 of 1125
processing file 820 of 1125
processing file 821 of 1125
processing file 822 of 1125
processing file 823 of 1125
processing file 824 of 1125
processing file 825 of 1125
processing file 826 of 1125
processing file 827 of 1125
processing file 828 of 1125
processing file 829 of 1125
processing file 830 of 1125
processing file 831 of 1125
processing file 832 of 1125
processing file 833 of 1125
processing file 834 of 1125
processing file 835 of 1125
processing file 836 of 1125
processing file 837 of 1125
processing file 838 of 1125
processing file 839 of 1125
processing file 840 of 1125
processing file 841 of 1125
processing file 842 of 1125
processing file 843 of 1125
processing file 844 of 1125
processing file 845 of 1125
processing file 846 of 1125
processing file 847 of 1125
processing file 848 of 1125
processing file 849 of 1125
processing file 850 of 1125
processing file 851 of 1125
processing file 852 of 1125
processing file 853 of 1125
processing file 854 of 1125
processing file 855 of 1125
processing file 856 of 1125
processing file 857 of 1125
processing file 858 of 1125
processing file 859 of 1125
processing file 860 of 1125
processing file 861 of 1125
processing file 862 of 1125
processing file 863 of 1125
processing file 864 of 1125
processing file 865 of 1125
processing file 866 of 1125
processing file 867 of 1125
processing file 868 of 1125
processing file 869 of 1125
processing file 870 of 1125
processing file 871 of 1125
processing file 872 of 1125
processing file 873 of 1125
processing file 874 of 1125
processing file 875 of 1125
processing file 876 of 1125
processing file 877 of 1125
processing file 878 of 1125
processing file 879 of 1125
processing file 880 of 1125
processing file 881 of 1125
processing file 882 of 1125
processing file 883 of 1125
processing file 884 of 1125
processing file 885 of 1125
processing file 886 of 1125
processing file 887 of 1125
processing file 888 of 1125
processing file 889 of 1125
processing file 890 of 1125
processing file 891 of 1125
processing file 892 of 1125
processing file 893 of 1125
processing file 894 of 1125
processing file 895 of 1125
processing file 896 of 1125
processing file 897 of 1125
processing file 898 of 1125
processing file 899 of 1125
processing file 900 of 1125
processing file 901 of 1125
processing file 902 of 1125
processing file 903 of 1125
processing file 904 of 1125
processing file 905 of 1125
processing file 906 of 1125
processing file 907 of 1125
processing file 908 of 1125
processing file 909 of 1125
processing file 910 of 1125
processing file 911 of 1125
processing file 912 of 1125
processing file 913 of 1125
processing file 914 of 1125
processing file 915 of 1125
processing file 916 of 1125
processing file 917 of 1125
processing file 918 of 1125
processing file 919 of 1125
processing file 920 of 1125
processing file 921 of 1125
processing file 922 of 1125
processing file 923 of 1125
processing file 924 of 1125
processing file 925 of 1125
processing file 926 of 1125
processing file 927 of 1125
processing file 928 of 1125
processing file 929 of 1125
processing file 930 of 1125
processing file 931 of 1125
processing file 932 of 1125
processing file 933 of 1125
processing file 934 of 1125
processing file 935 of 1125
processing file 936 of 1125
processing file 937 of 1125
processing file 938 of 1125
processing file 939 of 1125
processing file 940 of 1125
processing file 941 of 1125
processing file 942 of 1125
processing file 943 of 1125
processing file 944 of 1125
processing file 945 of 1125
processing file 946 of 1125
processing file 947 of 1125
processing file 948 of 1125
processing file 949 of 1125
processing file 950 of 1125
processing file 951 of 1125
processing file 952 of 1125
processing file 953 of 1125
processing file 954 of 1125
processing file 955 of 1125
processing file 956 of 1125
processing file 957 of 1125
processing file 958 of 1125
processing file 959 of 1125
processing file 960 of 1125
processing file 961 of 1125
processing file 962 of 1125
processing file 963 of 1125
processing file 964 of 1125
processing file 965 of 1125
processing file 966 of 1125
processing file 967 of 1125
processing file 968 of 1125
processing file 969 of 1125
processing file 970 of 1125
processing file 971 of 1125
processing file 972 of 1125
processing file 973 of 1125
processing file 974 of 1125
processing file 975 of 1125
processing file 976 of 1125
processing file 977 of 1125
processing file 978 of 1125
processing file 979 of 1125
processing file 980 of 1125
processing file 981 of 1125
processing file 982 of 1125
processing file 983 of 1125
processing file 984 of 1125
processing file 985 of 1125
processing file 986 of 1125
processing file 987 of 1125
processing file 988 of 1125
processing file 989 of 1125
processing file 990 of 1125
processing file 991 of 1125
processing file 992 of 1125
processing file 993 of 1125
processing file 994 of 1125
processing file 995 of 1125
processing file 996 of 1125
processing file 997 of 1125
processing file 998 of 1125
processing file 999 of 1125
processing file 1000 of 1125
processing file 1001 of 1125
processing file 1002 of 1125
processing file 1003 of 1125
processing file 1004 of 1125
processing file 1005 of 1125
processing file 1006 of 1125
processing file 1007 of 1125
processing file 1008 of 1125
processing file 1009 of 1125
processing file 1010 of 1125
processing file 1011 of 1125
processing file 1012 of 1125
processing file 1013 of 1125
processing file 1014 of 1125
processing file 1015 of 1125
processing file 1016 of 1125
processing file 1017 of 1125
processing file 1018 of 1125
processing file 1019 of 1125
processing file 1020 of 1125
processing file 1021 of 1125
processing file 1022 of 1125
processing file 1023 of 1125
processing file 1024 of 1125
processing file 1025 of 1125
processing file 1026 of 1125
processing file 1027 of 1125
processing file 1028 of 1125
processing file 1029 of 1125
processing file 1030 of 1125
processing file 1031 of 1125
processing file 1032 of 1125
processing file 1033 of 1125
processing file 1034 of 1125
processing file 1035 of 1125
processing file 1036 of 1125
processing file 1037 of 1125
processing file 1038 of 1125
processing file 1039 of 1125
processing file 1040 of 1125
processing file 1041 of 1125
processing file 1042 of 1125
processing file 1043 of 1125
processing file 1044 of 1125
processing file 1045 of 1125
processing file 1046 of 1125
processing file 1047 of 1125
processing file 1048 of 1125
processing file 1049 of 1125
processing file 1050 of 1125
processing file 1051 of 1125
processing file 1052 of 1125
processing file 1053 of 1125
processing file 1054 of 1125
processing file 1055 of 1125
processing file 1056 of 1125
processing file 1057 of 1125
processing file 1058 of 1125
processing file 1059 of 1125
processing file 1060 of 1125
processing file 1061 of 1125
processing file 1062 of 1125
processing file 1063 of 1125
processing file 1064 of 1125
processing file 1065 of 1125
processing file 1066 of 1125
processing file 1067 of 1125
processing file 1068 of 1125
processing file 1069 of 1125
processing file 1070 of 1125
processing file 1071 of 1125
processing file 1072 of 1125
processing file 1073 of 1125
processing file 1074 of 1125
processing file 1075 of 1125
processing file 1076 of 1125
processing file 1077 of 1125
processing file 1078 of 1125
processing file 1079 of 1125
processing file 1080 of 1125
processing file 1081 of 1125
processing file 1082 of 1125
processing file 1083 of 1125
processing file 1084 of 1125
processing file 1085 of 1125
processing file 1086 of 1125
processing file 1087 of 1125
processing file 1088 of 1125
processing file 1089 of 1125
processing file 1090 of 1125
processing file 1091 of 1125
processing file 1092 of 1125
processing file 1093 of 1125
processing file 1094 of 1125
processing file 1095 of 1125
processing file 1096 of 1125
processing file 1097 of 1125
processing file 1098 of 1125
processing file 1099 of 1125
processing file 1100 of 1125
processing file 1101 of 1125
processing file 1102 of 1125
processing file 1103 of 1125
processing file 1104 of 1125
processing file 1105 of 1125
processing file 1106 of 1125
processing file 1107 of 1125
processing file 1108 of 1125
processing file 1109 of 1125
processing file 1110 of 1125
processing file 1111 of 1125
processing file 1112 of 1125
processing file 1113 of 1125
processing file 1114 of 1125
processing file 1115 of 1125
processing file 1116 of 1125
processing file 1117 of 1125
processing file 1118 of 1125
processing file 1119 of 1125
processing file 1120 of 1125
processing file 1121 of 1125
processing file 1122 of 1125
processing file 1123 of 1125
processing file 1124 of 1125
processing file 1125 of 1125
constructing hklTable
sorting hklTable
DONE
</pre><h2 id="18">Plot of fine grid intensity vs. resolution (1/d)</h2><pre class="codeinput">load <span class="string">proc/mergeFine.mat</span> <span class="string">hklMerge</span>
load <span class="string">proc/export.mat</span> <span class="string">AverageGeometry</span>

h = hklMerge.h + hklMerge.dh/ndiv(1);
k = hklMerge.k + hklMerge.dk/ndiv(2);
l = hklMerge.l + hklMerge.dl/ndiv(3);

[sx,sy,sz] = AverageGeometry.hkl2s(h,k,l);
hklMerge.s = sqrt(sx.^2 + sy.^2 + sz.^2);

figure;plot(hklMerge.s,hklMerge.I,<span class="string">'.'</span>);
xlabel(<span class="string">'1/d (&Aring;^{-1})'</span>);ylabel(<span class="string">'Intensity'</span>);title(<span class="string">'Fine Map intensity vs. resolution'</span>);
clear <span class="string">hklMerge</span> <span class="string">sx</span> <span class="string">sy</span> <span class="string">sz</span> <span class="string">h</span> <span class="string">k</span> <span class="string">l</span> <span class="string">AverageGeometry</span>
</pre><img vspace="5" hspace="5" src="process_04.png" alt=""> <h2 id="19">Plot of fine grid intensity slice (l = 0)</h2><pre class="codeinput">load <span class="string">proc/mergeFine.mat</span> <span class="string">hklMerge</span>

hklMerge.hfrac = hklMerge.h + hklMerge.dh/ndiv(1);
hklMerge.kfrac = hklMerge.k + hklMerge.dk/ndiv(2);
hklMerge.lfrac = hklMerge.l + hklMerge.dl/ndiv(3);

<span class="comment">% create 3D array from hkl table</span>
E2A = proc.script.ExpandTableToArray(<span class="keyword">...</span>
    <span class="string">'hklcols'</span>,{<span class="string">'hfrac'</span>,<span class="string">'kfrac'</span>,<span class="string">'lfrac'</span>,<span class="string">'I'</span>},<span class="keyword">...</span>
    <span class="string">'SpaceGroup'</span>,symm.SpaceGroup(1),<span class="keyword">...</span>
    <span class="string">'symexpand'</span>,true,<span class="keyword">...</span>
    <span class="string">'ndiv'</span>,ndiv);

[P,I] = E2A.run(hklMerge);
[~,~,nl0] = P.frac2ind(0,0,0);
[h,~,~] = P.ind2frac(1:P.N(1),0,0);
[~,k,~] = P.ind2frac(0,1:P.N(2),0);

figure;imagesc(h,k,I(:,:,nl0)');colormap <span class="string">hot</span>
xlabel(<span class="string">'h'</span>);ylabel(<span class="string">'k'</span>);title(<span class="string">'Fine Map Intensity (l = 0)'</span>);colorbar

clear <span class="string">h</span> <span class="string">k</span> <span class="string">nl0</span> <span class="string">P</span> <span class="string">I</span> <span class="string">E2A</span> <span class="string">hklMerge</span>
</pre><img vspace="5" hspace="5" src="process_05.png" alt=""> <h2 id="20">Plot of CC* vs. resolution (1/d)</h2><pre class="codeinput">load <span class="string">proc/mergeFineSplit.mat</span> <span class="string">hklMerge</span>
load <span class="string">proc/export.mat</span> <span class="string">AverageGeometry</span>
C = AverageGeometry.Crystal;

hklMerge.hfrac = hklMerge.h + hklMerge.dh/ndiv(1);
hklMerge.kfrac = hklMerge.k + hklMerge.dk/ndiv(2);
hklMerge.lfrac = hklMerge.l + hklMerge.dl/ndiv(3);

ET2A = proc.script.ExpandTableToArray(<span class="keyword">...</span>
        <span class="string">'hklcols'</span>,{<span class="string">'hfrac'</span>,<span class="string">'kfrac'</span>,<span class="string">'lfrac'</span>,<span class="string">'I1'</span>,<span class="string">'I2'</span>},<span class="keyword">...</span>
        <span class="string">'SpaceGroup'</span>,symm.SpaceGroup(1),<span class="keyword">...</span>
        <span class="string">'symexpand'</span>,false,<span class="keyword">...</span>
        <span class="string">'ndiv'</span>,ndiv);

[P,I1,I2] = ET2A.run(hklMerge);

B = latt.Basis(C.a,C.b,C.c,C.alpha,C.beta,C.gamma);
B = latt.OrientedBasis.realign(B,C.a_axis,C.b_axis,C.c_axis);
SVR = proc.script.StatisticsVsRadius(<span class="keyword">...</span>
        <span class="string">'edges'</span>,0:.01:.6,<span class="keyword">...</span>
        <span class="string">'Basis'</span>,B.invert,<span class="keyword">...</span>
        <span class="string">'PeriodicGrid'</span>,P);

sr12 = SVR.run(I1,I2);

<span class="comment">% ccstar:</span>
cc12 = sr12.cc;
ccstar = sqrt(2*cc12./(1+cc12));

figure;plot(sr12.r,ccstar,<span class="string">'-'</span>,<span class="string">'DisplayName'</span>,<span class="string">'CC*'</span>);hold <span class="string">on</span>;
plot(sr12.r,cc12,<span class="string">'-'</span>,<span class="string">'DisplayName'</span>,<span class="string">'CC_{1/2}'</span>);
set(gca,<span class="string">'Ylim'</span>,[0,1]);
xlabel(<span class="string">'1/d (&Aring;^{-1})'</span>);ylabel(<span class="string">'Correlation Coefficient (CC)'</span>);legend <span class="string">show</span>

title(<span class="string">'Fine map, correlation of random half-sets vs. resolution'</span>);

clear <span class="string">hklMerge</span> <span class="string">C</span> <span class="string">AverageGeometry</span> <span class="string">P</span> <span class="string">I1</span> <span class="string">I2</span> <span class="string">B</span> <span class="string">SVR</span> <span class="string">sr12</span> <span class="comment">% save ccstar for next cell</span>
</pre><pre class="codeoutput">Warning: Imaginary parts of complex X and/or Y arguments ignored 
</pre><img vspace="5" hspace="5" src="process_06.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Process

%%
% check that mdx is on path
try
    geom.Detector();
catch
    error('mdx is not on the path! edit setup_environment.m and run');
end

%% Create input geometry objects
% hote: The normal workflow is to run XDS and import the geometry using
% proc.Batch.xds2geom() and proc.Batch.cbf2geom(). However, for this demo
% the simulated diffraction images are small and lack Bragg peaks, so
% XDS cannot be run beforehand. Running the input_geometry script
% creates the objects directly.

if ~isfolder('proc'), mkdir('proc'); end

input_geometry(); % creates proc/geom.mat and proc/geomBkg.mat

%% Integrate on a coarse grid (for scaling)

%% 
% *proc.Batch.filter*

[tf, errorMessage] = proc.Batch.filter(...
    'workingDirectory','proc',...
    'ndiv',[3,5,5],... % coarse grid divisions
    'maxCount',50,...  % histogram up to maxCount
    'parallel',false... % true requires parallel processing toolbox
    );  

if ~tf, rethrow(errorMessage);end
%% 
% *proc.Batch.integrate*

[tf,errorMessage] = proc.Batch.integrate(...
    'workingDirectory','proc',...
    'parallel',false... % requires parallel processing toolbox
    ); 

if ~tf, rethrow(errorMessage);end
%% 
% *proc.Batch.correct*

[tf,errorMessage] = proc.Batch.correct(...
    'workingDirectory','proc',...
    'parallel',false... % requires parallel processing toolbox
    );

if ~tf, rethrow(errorMessage);end
%% 
% *proc.Batch.export*
[tf,errorMessage] = proc.Batch.export(...
    'workingDirectory','proc');

if ~tf, rethrow(errorMessage);end
%% 
% *proc.Batch.combine*
[tf,errorMessage] = proc.Batch.combine(...
    'workingDirectory','proc',...
    'exportIn',{'export.mat'},...
    'mergeNeighbors',true,...
    'combineBragg',false,...
    'nwx',4,... % some default parameters for ScalingModel
    'nwy',4);

if ~tf, rethrow(errorMessage);end
%% 
% *proc.Batch.scale*

[tf,errorMessage] = proc.Batch.scale(...
    'workingDirectory','proc',...
    'scaleIn','combine.mat',...
    'bizMult',5,... % regularization parameter for smoothness of b
    'program',{'b',50,1E-4,'o',[],10,'a',20,1E-3}); 

if ~tf, rethrow(errorMessage);end

%% Plot of overall scale factor vs. frame number (b)

load proc/scale.mat ScalingModel

figure;plot(ScalingModel.Ia.wz,ScalingModel.b);
xlabel('Frame Number');ylabel('Scale Factor (b)');

clear ScalingModel
%% 
% *proc.Batch.merge*

[tf,errorMessage] = proc.Batch.merge(...
    'workingDirectory','proc');

if ~tf, rethrow(errorMessage);end

%% Plot of coarse map intensity vs. resolution (1/d)
load proc/merge.mat hklMerge

figure;plot(hklMerge.s,hklMerge.I,'.');
xlabel('1/d (Å^{-1})');ylabel('Intensity');title('Coarse Map intensity vs. resolution');
clear hklMerge

%% Plot of coarse map intensity slice (l = 0)

load proc/merge.mat hklMerge

% create 3D array from hkl table
E2A = proc.script.ExpandTableToArray(...
    'hklcols',{'hasu','kasu','lasu','I'},...
    'SpaceGroup',symm.SpaceGroup(1),...
    'symexpand',true,...
    'ndiv',[1,1,1]);

[P,I] = E2A.run(hklMerge);
[~,~,nl0] = P.frac2ind(0,0,0);
[h,~,~] = P.ind2frac(1:P.N(1),0,0);
[~,k,~] = P.ind2frac(0,1:P.N(2),0);

figure;imagesc(h,k,I(:,:,nl0)');
xlabel('h');ylabel('k');title('Coarse Map Intensity (l = 0)');colormap hot;colorbar

clear h k nl0 P I E2A hklMerge
%% Integrate on a fine grid

%% 
% *proc.Batch.grid*
%
% make a fine grid

ndiv = [5,15,15]; % number of divisions for the fine grid

[tf,errorMessage] = proc.Batch.grid(...
    'workingDirectory','proc',...
    'matOut','grid.mat',...
    'smax',Inf,...
    'getSymmetryEquivalents',true,...
    'ndiv',ndiv,...
    'excludeBraggPosition',true,...
    'parallel',false... % true requires parallel computing toolbox
    );

if ~tf, rethrow(errorMessage);end

%% 
% *proc.Batch.reintegrate*

[tf,errorMessage] = proc.Batch.reintegrate(...
    'workingDirectory','proc',...
    'geometryIn','geom.mat',...
    'bkgGeometryIn','geomBkg.mat',...
    'gridIn','grid.mat',...
    'scaleIn','scale.mat',...
    'matOut','reintegrate.mat',...
    'logOut','reintegrate.log',...
    'minimumCounts',0,...
    'minimumPixels',1,...
    'parallel',false... % true requires parallel computing toolbox
    );

if ~tf, rethrow(errorMessage);end

%% 
% *MergeScaledDiffuse*

% get crystal info
load proc/export.mat AverageGeometry

M = proc.script.MergeScaledDiffuse(...
    'Grid',grid.Sub3d('ndiv',ndiv),...
    'Crystal',AverageGeometry.Crystal,...
    'nMin',2,...
    'workingDirectory','proc');

AverageGeometry

% run the script on reintegrate.mat
fn = M.mapToColumns({'reintegrate.mat'});

[hklMerge,isincl] = M.mergeColumns(fn);

% save table to mat file
save('proc/mergeFine.mat','hklMerge');

% split and merge for calculating cc1/2, cc*
rng(0,'twister'); % set random number generator for reproducibility
[hklMerge] = M.mergeRandomHalfSets(fn,isincl);

save('proc/mergeFineSplit.mat','hklMerge');

M.clearTmp(fn); % clear files from temporary directory

clear hklMerge isincl M

%% Plot of fine grid intensity vs. resolution (1/d)
load proc/mergeFine.mat hklMerge
load proc/export.mat AverageGeometry

h = hklMerge.h + hklMerge.dh/ndiv(1);
k = hklMerge.k + hklMerge.dk/ndiv(2);
l = hklMerge.l + hklMerge.dl/ndiv(3);

[sx,sy,sz] = AverageGeometry.hkl2s(h,k,l);
hklMerge.s = sqrt(sx.^2 + sy.^2 + sz.^2);

figure;plot(hklMerge.s,hklMerge.I,'.');
xlabel('1/d (Å^{-1})');ylabel('Intensity');title('Fine Map intensity vs. resolution');
clear hklMerge sx sy sz h k l AverageGeometry

%% Plot of fine grid intensity slice (l = 0)
load proc/mergeFine.mat hklMerge

hklMerge.hfrac = hklMerge.h + hklMerge.dh/ndiv(1);
hklMerge.kfrac = hklMerge.k + hklMerge.dk/ndiv(2);
hklMerge.lfrac = hklMerge.l + hklMerge.dl/ndiv(3);

% create 3D array from hkl table
E2A = proc.script.ExpandTableToArray(...
    'hklcols',{'hfrac','kfrac','lfrac','I'},...
    'SpaceGroup',symm.SpaceGroup(1),...
    'symexpand',true,...
    'ndiv',ndiv);

[P,I] = E2A.run(hklMerge);
[~,~,nl0] = P.frac2ind(0,0,0);
[h,~,~] = P.ind2frac(1:P.N(1),0,0);
[~,k,~] = P.ind2frac(0,1:P.N(2),0);

figure;imagesc(h,k,I(:,:,nl0)');colormap hot
xlabel('h');ylabel('k');title('Fine Map Intensity (l = 0)');colorbar

clear h k nl0 P I E2A hklMerge

%% Plot of CC* vs. resolution (1/d)

load proc/mergeFineSplit.mat hklMerge
load proc/export.mat AverageGeometry
C = AverageGeometry.Crystal;

hklMerge.hfrac = hklMerge.h + hklMerge.dh/ndiv(1);
hklMerge.kfrac = hklMerge.k + hklMerge.dk/ndiv(2);
hklMerge.lfrac = hklMerge.l + hklMerge.dl/ndiv(3);

ET2A = proc.script.ExpandTableToArray(...
        'hklcols',{'hfrac','kfrac','lfrac','I1','I2'},...
        'SpaceGroup',symm.SpaceGroup(1),...
        'symexpand',false,...
        'ndiv',ndiv);

[P,I1,I2] = ET2A.run(hklMerge);
    
B = latt.Basis(C.a,C.b,C.c,C.alpha,C.beta,C.gamma);
B = latt.OrientedBasis.realign(B,C.a_axis,C.b_axis,C.c_axis);
SVR = proc.script.StatisticsVsRadius(...
        'edges',0:.01:.6,... 
        'Basis',B.invert,...
        'PeriodicGrid',P);

sr12 = SVR.run(I1,I2);

% ccstar:
cc12 = sr12.cc;
ccstar = sqrt(2*cc12./(1+cc12));

figure;plot(sr12.r,ccstar,'-','DisplayName','CC*');hold on;
plot(sr12.r,cc12,'-','DisplayName','CC_{1/2}');
set(gca,'Ylim',[0,1]);
xlabel('1/d (Å^{-1})');ylabel('Correlation Coefficient (CC)');legend show

title('Fine map, correlation of random half-sets vs. resolution');

clear hklMerge C AverageGeometry P I1 I2 B SVR sr12 % save ccstar for next cell

##### SOURCE END #####
--></body></html>